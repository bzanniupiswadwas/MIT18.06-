这就是本门课的最后一讲了，我们将会复习这个课程的内容。当然无法面面俱到！我们仍然是以习题为主！

# （1）
有一个矩阵A，有$Ax=\begin{bmatrix}1\\0\\0\end{bmatrix}$无解,$Ax=\begin{bmatrix}0\\1\\0\end{bmatrix}$有一个解！说说矩阵A的m,n,r之间的关系！
解：
首先根据矩阵乘法可以知道m=3！
然后，可以发现的是前面等式有一个无解的情况。这就说明$\begin{bmatrix}1\\0\\0\end{bmatrix}$不在矩阵A的列空间中。但是这并不说明矩阵A不是满足哦，因为我们都不知道矩阵A有多少列，万一只有两列呢！然后我们知道矩阵的秩一定小于3，如果等于三，那么一个三维向量不可能无解！所以m>r！然后后面有一个条件是只有一个解的。只有一个解的情况，说明零空间中只有零向量，那么说明矩阵A是列满秩的，那么n=r。所以m>n=r！

那么我们可以举出一个A的例子吗?
当然可以，比如$\begin{bmatrix}0\\1\\0\end{bmatrix}$,或者复杂一点可以是：$\begin{bmatrix}0&0\\1&0\\0&1\end{bmatrix}$。
然后当A=$\begin{bmatrix}0&0\\1&0\\0&1\end{bmatrix}$,我们有如下一系列判断题给到大家：
（a）:$|A^TA|=|AA^T|$
这个把例子一代就得出结论了！但其实如果A是一个方阵，这个结论是一定成立的！
（b）：$A^TA$可逆
正确，这判断不需要实际算出矩阵这里，因为 r=n，列满秩。此时矩阵 A 各列线性无关，矩阵可逆。（这个定理是证明过的，此外如果A不满秩，那么$A^TA$就不可逆！）
（c）:$AA^T$是正定矩阵
错误！矩阵$AA^T$ 规格是 3x3 的，但是秩为 2，所以一定不是正定矩阵。或者我们代入上面的例子计算即可发现错误！事实上，对任意实矩阵 A，$AA^T$总是半正定。
（d）：求证：对于方程 $A^Ty=c$ （c 为任意向量）至少有一解!
首先，矩阵$A^T$是行满秩的一个矩阵，这个矩阵就是典型的$r=m<n$，那么他是有无穷多个解的！

这整个题目似乎都是在复习Ax=b的可解性讨论问题，大家如果有不熟悉的地方回到1.10去复习复习！

# （2）
矩阵A是$\begin{bmatrix}v_{1}&v_{2}&v_{3}\end{bmatrix}$,v是列向量！
（a）Ax=$v_{1}-v_{2}+v_{3}$，求解x？
这真的是小菜一碟！x=$\begin{bmatrix}1\\-1\\1\end{bmatrix}$
如果这个不过关，那么应该回到第一单元复习矩阵乘法的内容！
（b）当$v_{1}-v_{2}+v_{3}=0$，那么解唯一吗？
其实就是在问A矩阵的零空间怎么样！明显$\begin{bmatrix}1\\-1\\1\end{bmatrix}$在矩阵A的零空间中，所以解不唯一！
（c）如果$v_1，v_{2}，v_{3}$ 标准正交， $v_{1}，v_{2}$ 怎样的线性组合最接近 $v_{3}$ ？
如果他们三个标准正交，那么在一个三维坐标系中，他们刚好是三条主轴。然后怎么样最接近，那就是问$v_{1}，v_{2}$构成的平面上，哪一点最接近于 $v_{3}$。那$v_{1}，v_{2}$构成的平面不就是xy平面，最接近的方式就是投影，z轴在xy平面投影就是原点，那么就是$0v_{1}+0v_{2}$最接近$v_{3}$！

前面两个题的题目都是聚焦于矩阵本身的空间与计算法则，这部分内容基础却十分重要，大家要好好复习！接下来我们就要复习一些特殊的矩阵，有着优良性质的矩阵！

# （3）

$$
A=\begin{bmatrix}
0.2 & 0.4 & 0.3\\
0.4 & 0.2 & 0.3\\
0.4 & 0.4 & 0.4
\end{bmatrix},\quad
\text{注意 } \text{第 } 1,2 \text{ 列之和}=2\times \text{第 } 3 \text{ 列}.
$$

#### a) 求 $A$ 的特征值
- 各列线性相关 $\Rightarrow$ $\lambda=0$ 是特征值。  
- $A$ 为马尔可夫矩阵 $\Rightarrow$ $\lambda=1$ 是特征值。（这是讲座中强调的结论！）
- $\mathrm{tr}(A)=0.8$，由迹与特征值关系得第三特征值为
  $$
  \lambda_3 = 0.8 - (0+1) = -0.2.
  $$
故特征值为
$$
\boxed{\lambda = 0,\; 1,\; -0.2}.
$$

#### b) 设 $u_k = A^k u(0)$，若
$$
u(0)=\begin{bmatrix}10\\0\\0\end{bmatrix},
$$
求 $\displaystyle \lim_{k\to\infty} u_k$.  实际上这是一个稳态问题！

研究稳态，我们直接给出通解（这些通解几乎都由欧拉公式推导而来，这就是为什么欧拉公式伟大的原因！）
将 $u_k$ 写成特征分解：
$$
u_k = c_1\lambda_1^k x_1 + c_2\lambda_2^k x_2 + c_3\lambda_3^k x_3
     = 0 + c_2\cdot 1^k x_2 + c_3(-0.2)^k x_3.
$$
当 $k\to\infty$ 时，$(-0.2)^k\to 0$，只剩 $\lambda=1$ 项。

求 $\lambda=1$ 对应的特征向量 $x_2$：
$$
(A-I)x_2 = 0 \Rightarrow
\begin{bmatrix}
-0.8 & 0.4 & 0.3\\
0.4 & -0.8 & 0.3\\
0.4 & 0.4 & -0.6
\end{bmatrix}x_2 = 0.
$$
可得
$$
x_2=\begin{bmatrix}3\\3\\4\end{bmatrix}.
$$
因此
$$
u_\infty = c_2\begin{bmatrix}3\\3\\4\end{bmatrix}.
$$
然后求$c_{2}$，你当然可以代入通解公式来求解，但是注意这是马尔科夫矩阵，还记得人口那个例子吗，其实马尔科夫计算的就是流动的概率，但是他的总和不变的，利用马尔可夫链“分量之和守恒”：
$$
u(0)\text{ 的分量和}=10 \Rightarrow c_2=1,
$$
最终
$$
\boxed{u_\infty = \begin{bmatrix}3\\3\\4\end{bmatrix}}.
$$

# （4）

找一个 $2\times 2$ 矩阵满足以下条件

#### a) 把向量投影到直线 $\mathrm{span}\!\left\{\begin{bmatrix}4\\-3\end{bmatrix}\right\}$ 上  
套公式即可
投影矩阵公式
$$
P=\frac{aa^{\mathsf T}}{a^{\mathsf T}a},\quad
a=\begin{bmatrix}4\\-3\end{bmatrix}.
$$
计算
$$
P=\frac{1}{25}\begin{bmatrix}16 & -12\\-12 & 9\end{bmatrix}=
\boxed{\begin{bmatrix}\dfrac{16}{25} & -\dfrac{12}{25}\\[2mm]-\dfrac{12}{25} & \dfrac{9}{25}\end{bmatrix}}.
$$
（可验证 $\det P = 0$。大家记住投影矩阵特征值是0或者1！）

#### b) 特征值为 $\lambda_1=0,\;\lambda_2=3$，对应特征向量 $x_1=\begin{bmatrix}1\\2\end{bmatrix},\;x_2=\begin{bmatrix}2\\1\end{bmatrix}$ ，求矩阵A
这个角度很新颖，我们从未如此过，如果是在考试中，也许我真的写不出来，但是其实不难，套公式即可！
用 $A=S\Lambda S^{-1}$：
$$
S=\begin{bmatrix}1 & 2\\2 & 1\end{bmatrix},\quad
\Lambda=\begin{bmatrix}0 & 0\\0 & 3\end{bmatrix},\quad
S^{-1}=\frac{1}{-3}\begin{bmatrix}1 & -2\\-2 & 1\end{bmatrix}.
$$
计算
$$
A=S\Lambda S^{-1}=
\begin{bmatrix}4 & -2\\2 & -1\end{bmatrix}.
$$
验证
$$
A x_1 = 0,\quad A x_2 = 3x_2.
$$

#### c) 一个矩阵A，元素都为实数，且不能写成 $B^{\mathsf T}B$ 形式  
$B^{\mathsf T}B$ 必对称，因此任何非对称矩阵均满足。例如
$$
\boxed{\begin{bmatrix}0 & 0\\1 & 0\end{bmatrix}}.
$$

#### d) 一个矩阵不对称，但具有正交特征向量  
对称矩阵必正交可对角化，但反对称或正交矩阵（允许复特征向量）也满足。示例：
- 斜对称：
  $$
  \boxed{\begin{bmatrix}0 & 1\\-1 & 0\end{bmatrix}}
  $$
- 正交（旋转）：
  $$
  \boxed{\begin{bmatrix}\cos\theta & -\sin\theta\\\sin\theta & \cos\theta\end{bmatrix}}.
  $$

# （5）

最小二乘问题
$$
\begin{bmatrix}1 & 0\\1 & 1\\1 & 2\end{bmatrix}
\begin{bmatrix}c\\d\end{bmatrix}
=
\begin{bmatrix}3\\4\\1\end{bmatrix},\quad
\text{解得}\quad
\begin{bmatrix}\hat c\\\hat d\end{bmatrix}
=
\begin{bmatrix}\dfrac{11}{3}\\[2mm]-1\end{bmatrix}.
$$
这个求解我们在讲座中讲过这个的公式，所以大家都能计算得出来！
#### a) 求 $b=\begin{bmatrix}3\\4\\1\end{bmatrix}$ 在列空间上的投影 $p$
其实我们说的最小二乘法逼近最优解，就是投影的结果，我们把近似解代入，得到的结果就是投影！
$$
p=\hat c\begin{bmatrix}1\\1\\1\end{bmatrix}+\hat d\begin{bmatrix}0\\1\\2\end{bmatrix}
=\begin{bmatrix}\dfrac{11}{3}\\[2mm]\dfrac{8}{3}\\[2mm]\dfrac{5}{3}\end{bmatrix}.
$$

#### b) 对应直线拟合图  
这个在讲座中也是有着详细的计算过程，这里略写一下，大家不熟悉回过头去看看2.3讲的部分！
取三点 $(0,3),\,(1,4),\,(2,1)$，拟合直线为
$$
y=\frac{11}{3}-t.
$$

#### c) 找一个非零向量 $b\in\mathbb R^3$ 使最小二乘解为 $\hat c=\hat d=0$  
需 $b$ 与 $A$ 的两列正交。b在A的左零空间中，计算得（左零空间的向量求取也十分简单，这里不赘述！）
$A^Tb=0$，得到：
$$
\boxed{b=\begin{bmatrix}1\\-2\\1\end{bmatrix}}.
$$

# 讨论课
# 第一题
矩阵A$=\begin{bmatrix}1&0&1\\0&1&1\\1&1&0\end{bmatrix}$
已知这个矩阵的两个特征值1和2，以及两个主元1和1。
（1）求解这个矩阵的第三个特征值与第三个主元？
特征值根据迹等于特征值总和，那么特征值等于-1。
而主元的乘积等于行列式，行列式等于特征值的积，那么主元是-2。
（2）如果$a_{33}$可以更改，那么找出一个最小的$a_{33}$使得矩阵A成为半正定矩阵？
现在矩阵A是$\begin{bmatrix}1&0&1\\0&1&1\\1&1&a_{33}\end{bmatrix}$,要成为半正定矩阵，那么矩阵的子行列式得大于等于0。而前面两个子行列式两个都是1，剩下的行列式就是其本身行列式，那么矩阵行列式等于$a_{33}-2\geq 0$，那么$a_{33}$最小就是2！

（3）如果让$A+cI$这个矩阵成为半正定矩阵，那么c最小值是多少？
此时矩阵是$\begin{bmatrix}1+c&0&1\\0&1+c&1\\1&1&c\end{bmatrix}$,这个时候我们来看他的特征值来判断，A特征值是1，1，-1，那么$A+cI$特征值就是1+c，1+c，-1+c。那么$c\geq 1$，c的最小值是1！


# 第二题
首先$u_{0}$等于$\begin{bmatrix}3\\0\\0\end{bmatrix},\begin{bmatrix}0\\3\\0\end{bmatrix},\begin{bmatrix}0\\0\\3\end{bmatrix}$其中的一个，然后$U_{k+1}=\frac{1}{2}U_{k}$，而$\frac{1}{2}A=\begin{bmatrix} \frac{1}{2} & 0 & \frac{1}{2} \\ 0& \frac{1}{2} & \frac{1}{2} \\ \frac{1}{2} & \frac{1}{2}&0 \end{bmatrix}$,求出$U_{k}$当k趋近于正无穷的时候！
首先，给出差分方程的通解$U_{k}=c_{1}\lambda_{1}^k x_{1}+c_{2}\lambda_{2}^k x_{2}+c_{3}\lambda_{3}^k x_{3}$。我们求得$\frac{1}{2}A$的特征值是$\frac{1}{2},1,-\frac{1}{2}$。所以稳态是$c_{2}x_{2}$，我们求得特征值对应的特征向量是$\begin{bmatrix}1\\1\\1\end{bmatrix}$。那么这个时候我们就得求$c_{2}$了。但是我们发现$\frac{1}{2}A$是马尔科夫矩阵，而马尔科夫通解方程与差分方程是一样，但是马尔科夫方程的好处是求解概率的，他不会改变总量！而上面三个不同初始状态的总量都是3，那么$c_{2}$等于1。当然，你也可以一个个代入$u_{0}$去求解初始状态！


到此复习完毕！
