
## 1（共 11 分）

设 $A$ 为 $3\times 4$ 矩阵，且方程 $Ax=0$ 恰好有两个特解：
$$
x_1=\begin{bmatrix}1\\1\\1\\0\end{bmatrix},\qquad
x_2=\begin{bmatrix}-2\\-1\\0\\1\end{bmatrix}.
$$

### (a) 求其行最简形 $R$。

### (b) 求四个基本子空间 $C(A),N(A),C(A^\mathsf{T}),N(A^\mathsf{T})$ 的维数，并给出你能确定的一个或多个子空间的基底。

---

### 解答

#### (a)

由特解可知自由变量为第 3、4 列（这个是在第一单元提到过的知识点），主元列为第 1、2 列，故
$$
R=\begin{bmatrix}
1 & 0 & -1 & 2\\
0 & 1 & -1 & 1\\
0 & 0 & 0 & 0
\end{bmatrix}.
$$

#### (b)

- **零空间 $N(A)$**：维数 $4-2=2$，基底为 $x_1,x_2$。
- **行空间 $C(A^\mathsf{T})$**：维数 $2$，基底可取 $R$ 的前两行：
  $$
  \left\{
  \begin{bmatrix}1\\0\\-1\\2\end{bmatrix},
  \begin{bmatrix}0\\1\\-1\\1\end{bmatrix}
  \right\}.
  $$
- **列空间 $C(A)$**：维数 $2$，基底为 $A$ 的前两列（未知具体数值）。
- **左零空间 $N(A^\mathsf{T})$**：维数 $1$，基底为与 $C(A)$ 正交的非零向量。

---

## 2（共 11 分）

设上三角矩阵
$$
U=\begin{bmatrix}
a & b & c\\
0 & d & e\\
0 & 0 & f
\end{bmatrix},\quad a,b,c,d,e,f\ne 0.
$$

### (a) 求 $U^{-1}$。

### (b) 若 $U$ 的列是某矩阵 $A$ 的特征向量，证明 $A$ 也是上三角矩阵。

### (c) 说明此 $U$ 不可能等于 SVD 中的 $U$ 因子。

---

### 解答

#### (a)
$$
U^{-1}=\begin{bmatrix}
\frac{1}{a} & -\frac{b}{ad} & \frac{be-cd}{adf}\\[4pt]
0 & \frac{1}{d} & -\frac{e}{df}\\[4pt]
0 & 0 & \frac{1}{f}
\end{bmatrix}.
$$

#### (b)

$A=U\Lambda U^{-1}$，其中 $\Lambda$ 为对角矩阵，$U$ 与 $U^{-1}$ 均为上三角，故 $A$ 亦上三角。

#### (c)

SVD 要求 $U$ 的列正交，而 $U$ 前两列内积为 $ab\ne 0$，非正交，故不可能。

---

## 3（共 11 分）

### (a) 对同阶矩阵 $A,B$，比较 $\operatorname{rank}(A)$ 与 $\operatorname{rank}\bigl([A\;B]\bigr)$。

### (b) 若 $B=A^2$，比较两者秩。

### (c) 若 $A$ 为 $m\times n$ 秩为$r$，求 $N(A)$ 与 $N\bigl([A\;A]\bigr)$ 的维数。

---

### 解答

- (a) $\operatorname{rank}(A)\le\operatorname{rank}\bigl([A\;B]\bigr)$。矩阵A可以有任意数量r个主元列，这些列都是$[A B]$的主元列；但B的列中可能还有更多的主元列
- (b) $\operatorname{rank}(A)=\operatorname{rank}\bigl([A\;A^2]\bigr)$，因为 $A^2$ 的列均为 $A$ 列的线性组合。例如，如果我们将A的第一列称为$a_{1}$，则$Aa_{1}$是$A^2$的第一列。因此，在$[A A^2]$的$A^2$部分中没有新的主元列。
- (c) $\dim N(A)=n-r$；$\dim N\bigl([A\;A]\bigr)=2n-r$。

---

## 4（共 12 分）

设 $A$ 为 $5\times 3$ 矩阵且 $Ax\ne 0$ 对所有非零 $x$ 成立。

### (a) 关于 $A$ 的列有何结论？

### (b) 证明 $A^\mathsf{T}Ax\ne 0$ 对所有非零 $x$ 成立。

### (c) 说明 $B=(A^\mathsf{T}A)^{-1}A^\mathsf{T}$ 为 $A$ 的左逆，而非右逆。

---

### 解答

- (a) 列线性无关，$\operatorname{rank}(A)=3$。
- (b) 若 $A^\mathsf{T}Ax=0$，则 $x^\mathsf{T}A^\mathsf{T}Ax=\|Ax\|^2=0\Rightarrow Ax=0$，与题设矛盾。
- (c) $BA=I_3$，故为左逆；但 $AB$ 为 $5\times 5$ 秩为 3的矩阵，不可能等于 $I_5$因为单位矩阵是满秩的，故非右逆。

---

## 5（共 10 分）

设 $3\times 3$ 对称正定矩阵 $A$ 有正特征值 $\lambda_1<\lambda_2<\lambda_3$ 及对应标准正交特征向量 $q_1,q_2,q_3$。令 $x=c_1q_1+c_2q_2+c_3q_3$。

### (a) 计算 $x^\mathsf{T}x$ 与 $x^\mathsf{T}Ax$。

### (b) 求使 Rayleigh 商 $\dfrac{x^\mathsf{T}Ax}{x^\mathsf{T}x}$ 最大的 $x$ 形式。

---

### 解答

- (a)
$$
x^\mathsf{T}x \;=\; (c_1q_1^\mathsf{T} + c_2q_2^\mathsf{T} + c_3q_3^\mathsf{T})(c_1q_1 + c_2q_2 + c_3q_3) \\
\;=\; c_1^2q_1^\mathsf{T}q_1 + c_1c_2q_1^\mathsf{T}q_2 + \cdots + c_3c_2q_3^\mathsf{T}q_2 + c_3^2q_3^\mathsf{T}q_3 \\
\;=\; c_1^2 + c_2^2 + c_3^2.
$$

$$
x^\mathsf{T}Ax \;=\; (c_1q_1^\mathsf{T} + c_2q_2^\mathsf{T} + c_3q_3^\mathsf{T})(c_1Aq_1 + c_2Aq_2 + c_3Aq_3) \\
\;=\; (c_1q_1^\mathsf{T} + c_2q_2^\mathsf{T} + c_3q_3^\mathsf{T})(c_1\lambda_1q_1 + c_2\lambda_2q_2 + c_3\lambda_3q_3) \\
\;=\; c_1^2\lambda_1q_1^\mathsf{T}q_1 + c_1c_2\lambda_2q_1^\mathsf{T}q_2 + \cdots + c_3c_2\lambda_2q_3^\mathsf{T}q_2 + c_3^2\lambda_3q_3^\mathsf{T}q_3 \\
\;=\; c_1^2\lambda_1 + c_2^2\lambda_2 + c_3^2\lambda_3.
$$
- (b) 
我们最大化 $\dfrac{(c_1^2\lambda_1 + c_2^2\lambda_2 + c_3^2\lambda_3)}{(c_1^2 + c_2^2 + c_3^2)}$ 当 $c_1 = c_2 = 0$ 时，结果等于$\lambda_{3}$，所以 $x = c_3q_3$ 是具有最大特征（因为特征值3最大）值 $\lambda_3$ 的特征向量 $q_3$ 的倍数。所以取 $c_1=c_2=0$，$x$ 与 $q_3$ 共线时取得最大值 $\lambda_3$。因为特征值3最大，这就是为什么我们让$c_{1},c_{2}$等于0的原因！

（还要注意，这个“Rayleigh 商” $x^\mathsf{T}Ax/x^\mathsf{T}x$ 的最大值本身就是最大的特征值。这是寻找特征向量的另一种方法：通过数值最大化 $x^\mathsf{T}Ax/x^\mathsf{T}x$。）

---


## 6（共 12 分）

(a) 求与 u 正交且能由线性无关向量 v 和 u 线性表示的向量 w。

(b) 对于 2 列矩阵 $A = \begin{bmatrix} u & v \end{bmatrix}$，找到 Q（列正交归一）和 R（2 乘 2 上三角）使得 $A = QR$。

(c) 仅使用 Q，通过 $A = QR$ 找到投影矩阵 P 到由 u 和 v 张成的平面上。

---

### 解答

(a) 你可以简单地写下 $w = 0u + 0v = 0$ —— 这是与任何向量都垂直的！但一个更有用的选择是减去足够的 u 使得 $w = v - cu$ 与 u 正交。这意味着 $0 = w^\mathsf{T}u = v^\mathsf{T}u - cu^\mathsf{T}u$，所以 $c = \frac{v^\mathsf{T}u}{u^\mathsf{T}u}$ 并且 $w = v - \frac{(v^\mathsf{T}u)u}{u^\mathsf{T}u}$。

(b) 我们已经知道 u 和 w 是正交的；只需对它们进行归一化！取 $q_1 = \frac{u}{|u|}$ 和 $q_2 = \frac{w}{|w|}$，他们就可以作为Q的列。然后解出 R 的列 $r_1, r_2$：$Qr_1 = u$ 所以 $r_1 = \begin{bmatrix} |u| \\ 0 \end{bmatrix}$，并且 $Qr_2 = v$ 所以 $r_2 = \begin{bmatrix} c|u| \\ |w| \end{bmatrix}$。（其中 $c = \frac{v^\mathsf{T}u}{u^\mathsf{T}u}$ 如前所述。）然后 $Q = [q_1 \; q_2]$ 和 $R = [r_1 \; r_2]$。

(c) $P = A(A^\mathsf{T}A)^{-1}A^\mathsf{T} = (QR)(R^\mathsf{T}Q^\mathsf{T}QR)^{-1}(R^\mathsf{T}Q^\mathsf{T}) = (QR)(R^\mathsf{T}Q^\mathsf{T}) = QQ^\mathsf{T}$。这个正常计算就可以得到！

---

## 7（共 11 分）

(a) 求矩阵
$$
C = \begin{bmatrix}
0 & 0 & 0 & 1 \\
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{bmatrix}
$$
和 $$C^2 = \begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{bmatrix}$$ 的特征值。

(b) 这两个都是置换矩阵。求它们的逆 $C^{-1}$ 和 $(C^2)^{-1}$？

(c) 求 $C$ 和 $C + I$ 以及 $C + 2I$ 的行列式。

---

### 解答

(a) 取 $C - \lambda I$ 的行列式（我通过余子式展开）：$\lambda^4 - 1 = 0$。这个“特征方程”的根是特征值：+1, -1, i, -i。

$C^2$ 的特征值就是 $\lambda^2 = \pm 1$（各两个）。

（这里有一种“猜测”方法。由于 $C^4 = I$，所有 $C^4$ 的特征值 $\lambda^4$ 都是 1：所以 $\lambda = 1, -1, i, -i$ 是唯一可能的。只需检查哪些是可行的。然后 $C^2$ 的特征值必须是 $\pm 1$。）

(b) 对于任何置换矩阵，$C^{-1} = C^\mathsf{T}$：所以
$$
C^{-1} = \begin{bmatrix}
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
1 & 0 & 0 & 0
\end{bmatrix}
$$
和 $(C^2)^{-1} = C^2$ 是它自己。

(c) $C$ 的行列式是其特征值的乘积：$1(-1)i(-i) = -1$。

将每个特征值加 1 得到 $C + I$ 的特征值（如果 $C = S\Lambda S^{-1}$，那么 $C + I = S(\Lambda + I)S^{-1}$）：$2(0)(1 + i)(1 - i) = 0$（或者让 $\lambda = -1$ 在特征方程 $\det(C - \lambda I)$ 中。）

加 2 得到 $C + 2I$ 的特征值（或者让 $\lambda = -2$）：$3(1)(2 + i)(2 - i) = 15$。

---

## 8（共 11 分）

假设一个矩形矩阵 $A$ 有独立的列。

(a) 如何找到 $Ax = b$ 的最佳最小二乘解 $\hat{x}$？通过这些步骤，给我一个 $\hat{x}$ 和 $p = A\hat{x}$ 的公式（字母而不是数字）。

(b) 投影 $p$ 在与 $A$ 相关的哪个基本子空间中？误差向量 $e = b - p$ 在哪个基本子空间中？

(c) 通过任何方法找到投影矩阵 $P$ 到 $A$ 的列空间：
$$
A = \begin{bmatrix}
1 & 0 \\
3 & 0 \\
0 & -1 \\
0 & -3
\end{bmatrix}.
$$

---

### 解答

(a)这个在讲座中就推导过！
$$
Ax = b \\
\text{最小二乘“解”：} \quad A^\mathsf{T}A\hat{x} = A^\mathsf{T}b \\
A^\mathsf{T}A \text{ 是可逆的：} \quad \hat{x} = (A^\mathsf{T}A)^{-1}A^\mathsf{T}b \\
\text{并且} \quad p = A\hat{x} \text{ 是：} \quad A\hat{x} = A(A^\mathsf{T}A)^{-1}A^\mathsf{T}b
$$

(b) $p = A\hat{x}$ 是 $A$ 的列的线性组合，所以它在列空间 $C(A)$ 中。误差 $e = b - p$ 与这个空间正交，所以它在左零空间 $N(A^\mathsf{T})$ 中。

(c) 我使用了 $P = A(A^\mathsf{T}A)^{-1}A^\mathsf{T}$。由于 $A^\mathsf{T}A = \begin{bmatrix} 10 & 0 \\ 0 & 10 \end{bmatrix}$，它的逆是 $\begin{bmatrix} 1/10 & 0 \\ 0 & 1/10 \end{bmatrix}$，并且
$$
P = \frac{1}{10} \begin{bmatrix}
1 & 3 & 0 & 0 \\
3 & 9 & 0 & 0 \\
0 & 0 & 1 & 3 \\
0 & 0 & 3 & 9
\end{bmatrix}.
$$

---

## 9（共 11 分）

考虑主对角线上有 3，主对角线上方有 2，主对角线下方有 1 的矩阵：
$$
A_1 = \begin{bmatrix}
3 & 2 & 0 \\
1 & 3 & 2 \\
0 & 1 & 3
\end{bmatrix}, \quad
A_2 = \begin{bmatrix}
3 & 2 & 0 & 0 \\
1 & 3 & 2 & 0 \\
0 & 1 & 3 & 2 \\
0 & 0 & 1 & 3
\end{bmatrix}, \quad
A_3 = \begin{bmatrix}
3 & 2 & 0 & 0 & 0 \\
1 & 3 & 2 & 0 & 0 \\
0 & 1 & 3 & 2 & 0 \\
0 & 0 & 1 & 3 & 2 \\
0 & 0 & 0 & 1 & 3
\end{bmatrix}, \quad
\cdots, \quad
A_n = \begin{bmatrix}
3 & 2 & 0 & \cdots & 0 & 0 \\
1 & 3 & 2 & \cdots & 0 & 0 \\
0 & 1 & 3 & \cdots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \cdots & 3 & 2 \\
0 & 0 & 0 & \cdots & 1 & 3
\end{bmatrix}.
$$

### (a) 求 $A_2$ 和 $A_3$ 的行列式。

### (b) $A_n$ 的行列式是 $D_n$。使用第一行和第一列的余子式找到 $D_n$ 的递推公式中的系数 $a$ 和 $b$：
$$
D_n = a D_{n-1} + b D_{n-2}.
$$

### (c) 这个方程 ($D_n = a D_{n-1} + b D_{n-2}.$) 与下列矩阵的特征方程相同：
$$
\begin{bmatrix}D_n\\D_{n-1}\end{bmatrix}=\begin{bmatrix}a&b\\1&0\end{bmatrix}\begin{bmatrix}D_{n-1}\\D_{n-2}\end{bmatrix}
$$
从该矩阵的特征值来看，行列式 $D_n$ 的增长速率如何？（如果你没有找到 $a$ 和 $b$，说明你将如何回答任何 $a$ 和 $b$ 的情况下的 (c) 部分。）对于第一点，求出 $D_5$。

---

### 解答

(a) $\det(A_2) = 3 \cdot 3 - 1 \cdot 2 = 7$ 和 $\det(A_3) = 3 \cdot \det(A_2) - 2 \cdot 1 \cdot 3 = 15$。

(b) $D_n = 3D_{n-1} + (-2)D_{n-2}$。（这个代入数据展开即可得到！）

(c) （就是一个差分方程！）该矩阵A的迹是 $a = 3$，行列式是 $-b = 2$。所以特征方程为 $\lambda^2 - a\lambda - b = 0$，其根（即特征值）为 $\lambda_\pm = \frac{3 \pm \sqrt{9 + 8}}{2} = 1$ 或 $2$。而$D_n=a 2^n+b 1^n$ （这个公式是换元得来，我们首先需要假定解进行反推！这个公式就是递推关系的通解形式！），由这个公式得到$D_n$ 的增长速率与 $A_n$ 的最大特征值 $\lambda_n = 2^n$ 相同。但是我们说了这个其实也是一个差分方程，考试中让我们推导出递推关系的通解有点困难，但是差分方程的通解我们知道的，通解为$u_{k}= c_{1}λ_{1}^kx_{1}+ c_{2}λ_{2}^kx_{2}$，明显特征值为1的那一项对增长没有什么作用，主要是特征值为2的那一项对增长有贡献！

最后的一点：$D_5 = 3D_4 + 2D_3 = 3(3D_3 + 2D_2) + 2D_3 = 11D_3 + 6D_2 = 207$。

本章除了最后一题第二问比较困难，其他题目没有计算上与理解上的刁难（当然如果大家能够联想到差分方程，也是很简单的！），大家好好写这张试卷检验自己的学习成果！

到此，本门课程全部结束！完结撒花！线性代数虽然难以理解，但是这门课程尽量讲得通俗易懂，正如教授所说，数学是给每个人准备的，如果别人可以会，当然，你也可以！