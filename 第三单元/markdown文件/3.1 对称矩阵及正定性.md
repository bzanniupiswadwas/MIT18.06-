# 对称矩阵
分析一个矩阵，我们已经习惯从特征向量与特征值出发去研究了！那么我们认然以特征向量与特征值去认识对称矩阵。首先我们说出两个重要的性质：
1）所有特征值都是实数（也就是不会存在复数的情况，所以如果你是工程专业的学生大概率不会深入了解他，因为他不收敛！）
2）所有的特征向量都正交。（注意，如果出现重复的特征值的情况，选出一组即可。就是说值不同的特征值对应的特征向量是正交的！）对称矩阵不同特征值对应的特征向量是正交的，但是不意味着同一个特征值对应的特征向量不正交！
性质一我们会稍后证明，而性质二需要大家自行去翻阅资料。（值得一提的是我们这么多讲座中，strang教授都秉承着一个原则，能不证明就不证明，我们文档中仅有的这些证明一部分还是我自行查阅资料得到的，所以大家如果想要深入了解许多我们没有提到的证明的话，建议大家去阅读strang教授的教材[https://math.mit.edu/~gs/linearalgebra/ila6/indexila6.html]，这里面几乎是包含了我们讲座中所有略过的证明，不过这个网址被墙了，大家可能需要点魔法去阅读，或者大家有闲钱的话在亚马逊上买上一本，也算是对老教授的支持！）

这两个性质可以得到我们之前说过的一个结论，对称矩阵一定是可以对角化的（这个证明我们也略过，但是证明过程是围绕这两个性质的，大家感兴趣自行查阅！）也就是说对称矩阵的特征向量矩阵是正交矩阵！

# 对称矩阵的分解
我们上面已经得知，对称矩阵是可以对角化的，那么对称矩阵A一定是可以写成：$A=S\Lambda S^{-1}$。而我们知道的是对称矩阵的特征向量矩阵是正交矩阵！如果我们加一个系数，那么特征向量矩阵就可以化为标准正交矩阵。所以矩阵A可以写成：$A=Q\Lambda Q^{-1}$，而标准正交矩阵的逆矩阵等于他的转置，所以矩阵A为$A=Q\Lambda Q^{T}$。这个分解一眼可以看出是对称的，因为：$(Q\Lambda Q^{T})^T=Q\Lambda Q^{T}$。而这个分解，在力学上被称为主轴定理也就是主应力空间，它意味着如果给定某种材料，在合适的轴上来看，它就会变成对角化的，方向就不会重复。而在数学上，这被称为“谱定理”，好像是来源于光谱理论！如果您是材料力学专业的话，应该会经常用到这个知识点去计算主应力！


# 对称矩阵的特征值
现在我们要证明性质一了，证明如下：
由特征值公式：$$Ax=\lambda x$$
在这里我们先假设A是实数矩阵！那么而其它的特征值与特征向量都有可能是复数的！那么我们就假设都为复数进行反推，对该公式取共轭得到（共轭后公式仍然成立！）：$$A\bar{x}=\bar{\lambda}\bar{x}$$
然后我们取转置得到的是：$$\bar{x}^TA=\bar{x}^T\bar{\lambda}$$
两侧同时乘上 x 构造方程，可得：$$\bar{x}^TAx=\bar{\lambda}\bar{x}^Tx$$
然后把$Ax=\lambda x$代入到上面公式可以得到的是：$$\bar{x}^T\lambda x=\bar{\lambda}\bar{x}^Tx$$
得到$\bar{\lambda}=\lambda$，那么他一定是实数！
有同学会疑惑，这样可以约分吗，不会出现0的情况吗，其实不会的！$$\bar{x}^Tx=\begin{bmatrix}\bar{x}_{1}&\bar{x}_{2}&\bar{x}_{3}&\dots&\bar{x}_{n}\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\\x_{3}\\\dots\\x_{n}\end{bmatrix}=\bar{x}_{1}x_{1}+\bar{x}_{2}x_2+\bar{x}_{3}x_{3}+\dots+\bar{x}_{n}x_{n}$$
而其中的$𝑥_{i}$均为$(a+bi)(a-bi)$，得到的均为实数且大于 0(这就是求解复平面向量长度的公式)。仅当 x 为零向量时，其内积为 0。而对称矩阵的特征向量 x 不是零向量，那么 $\bar{x}^Tx$= 0 情况不存在，所以对称矩阵特征值均为实数。

当然，我们还有一个前提是矩阵A是实数矩阵，不是复数矩阵，而只要满足$\bar{A}^T=A$,（共轭转置等于其本身）则其对称矩阵是实数，证明过程和上面是一模一样的，改对应条件即可！不过这个做个了解即可，我们大部分都是考虑实数对称矩阵的！

在知道了其特征值为实数之后，下面我们还需要探究其是正数还是负数。这很重要，这关乎到微分方程的稳定状态！给出对称矩阵特殊性质如下：
（1） 对称矩阵的主元正负个数与特征值的正负个数对应一致。
正主元个数 = 正特征值个数
负主元个数 = 负特征值个数

（2）对称矩阵的主元的乘积等于特征值的乘积（它们都等于矩阵行列式的值）
这个证明还是很简单的，对称矩阵都是方阵，$Q\Lambda Q^{-1}=QQ^{-1}\Lambda=I\Lambda$,所以是可以化为对角矩阵的，那么主元就是对角线元素，而行列式等于对角线元素乘积，特征值乘积也等于行列式，那么主元的乘积等于特征值的乘积！
这提供了一种更方便的方式来了解对称矩阵的特征值多少个为正，多少为负。因为在矩阵规格很大的情况下，求矩阵的主元要远比求其特征值要简单得多，前一个消元就好，后一个还要解方程。

# 对称矩阵的别样视角
我们知道$A=Q\Lambda Q^{T}$，那么我们展开：$$A=Q\Lambda Q^{T}=\begin{bmatrix}q_{1}&q_{2}&q_{3}&\dots&q_{n}\end{bmatrix}\begin{bmatrix}λ_{1}&0&\dots&0\\0&λ_{2}&\dots&0\\0&0&\dots&0\\0&0&0&λ_{n}\end{bmatrix}\begin{bmatrix}q_{1}^T\\q_{2}^T\\q_{3}^T\\\dots\\q_{n}^T\end{bmatrix}$$
计算后得到：$A=λ_{1}q_{1}q_{1}^T+λ_{2}q_{2}q_{2}^T+\dots$
由于$q_{i}$都是单位向量，所以$q_{1}^Tq_{1}$是一个常数，且值为1。那么当以$q_{i}$为投影背景的投影矩阵就是：$\frac{q_{i}q_{i}^T}{q_{1}^Tq_{1}}=q_{i}q_{i}^T$。所以我们说每一个对称矩阵都是一些互相垂直的投影矩阵的线性组合。

# 初尝正定矩阵
这一节中提前渗透一些正定矩阵的内容，了解即可，下面两讲对正定矩阵会进行详细叙述。

所谓正定矩阵就是一类对称矩阵，是对称矩阵的子集，满足：

（1）所有的特征值是正数
（2）所有主元为正
（3）所有的子行列式都为正
（4）行列式是正数

>tips：子行列式概念：
从原行列式左上角开始依次划分出 1x1 的一块,2x2 的一块，...得到的这些子块对应的行列式就称之为“子行列式”。

但是这里要注意，行列式为正数的矩阵不一定都是正定矩阵，要满足“所有的子行列式都为正”才可以。

从主元到行列式再到特征值，这些性质就将本门课的主要内容很好地融合在了一起。这样一来，我们以前问题的探讨会方便很多。例如：矩阵的特征值就是计算微分方程时的关键条件。因为根据特征值的正负与否我们就知道其稳定与否。


# 讨论课
下面我们来讨论一下正定矩阵的一些性质！
a) 为什么正定矩阵都是可逆的？
首先如果一个矩阵不可逆，那么矩阵的行列式是等于0的！而一个正定矩阵的特征值都大于0，而行列式等于特征值的积，所以行列式大于0，那么矩阵就是一定可逆的！

b) 证明唯一的即是正定矩阵又是投影矩阵的矩阵是单位矩阵！
首先投影矩阵的特征值不是1就是0，因为：
设 \(P\) 是一个**实投影矩阵**，满足

1. 幂等： $P^2 = P$；
2. 对称： $P^\top = P$。

取任意特征对 $(\lambda, \mathbf v)$，其中 $\mathbf v \neq \mathbf 0$，则有
$P\mathbf v = \lambda \mathbf v.$

利用幂等性：
$P^2\mathbf v = P\mathbf v \quad\Longrightarrow\quad P(\lambda \mathbf v) = \lambda \mathbf v\quad\Longrightarrow\quad \lambda^2 \mathbf v = \lambda \mathbf v.$

于是
$(\lambda^2 - \lambda)\mathbf v = \mathbf 0.$

由于 $\mathbf v \neq \mathbf 0$，立刻得到
$\lambda(\lambda - 1) = 0 \quad\Longrightarrow\quad \lambda = 0 \text{ 或 } 1.$

因此，投影矩阵的所有特征值**只能是 0 或 1**。

而正定矩阵的特征值都是大于0的，那么这样的矩阵特征值只能都为1！
那么特征值全为一且是可对角化（正定矩阵都可对角化）的矩阵只能是单位矩阵，因为：如果把矩阵对角化可以写为$SIS^{-1}$，因为特征值全为1，那么对角矩阵是单位矩阵！那么$SIS^{-1}=SS^{-1}=I$，所以是单位矩阵，证明完毕！

c) 一个对角矩阵，如果元素都是正数，证明他是一个正定矩阵！
这之前我们要说一个事实：当且仅当对 **所有非零向量** x，都有$x^⊤Ax>0.$

设$D = \mathrm{diag}(d_1,d_2,\dots,d_n),\quad d_i>0\;(i=1,\dots,n).$
对任意非零向量
$\mathbf x = (x_1,x_2,\dots,x_n)^\top \in\mathbb R^n\setminus\{\mathbf 0\},$

计算二次型：
$\mathbf x^\top D\mathbf x= \sum_{i=1}^{n} d_i x_i^{2}.$

- 因为 $d_i>0$且 $x_i^{2}\ge 0$，每一项 $d_i x_i^{2}\ge 0$。  
- 由于 $\mathbf x\neq \mathbf 0$，至少存在某个 \(k\) 使得 $x_k\neq 0$，于是 $d_k x_k^{2}>0$。  
- 因此$\sum_{i=1}^{n} d_i x_i^{2}>0.$

根据正定矩阵的定义，$\forall\,\mathbf x\neq\mathbf 0,\;\mathbf x^\top D\mathbf x>0$，故 D 为正定矩阵。

d) 一个对称矩阵，如果行列式大于0，证明他不一定是正定矩阵！
随便就可以举出一个反例：$\begin{bmatrix}-3&1\\1&-2\end{bmatrix}$。

# 习题课

## 习题 1

下面是一个**错误证明**：“所有实矩阵的特征值都是实数”：

> 若 $Ax = \lambda x$，则  
>  $x^\top A x = \lambda x^\top x$，于是  
> $\lambda = \frac{x^\top A x}{x^\top x}.$

该证明隐含了一个**未声明的假设**，并不总是成立。  
请用 90° 旋转矩阵  
$A = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}$
来检验每一步，取复特征值 $\lambda = i$和对应的特征向量  
$x = \begin{pmatrix} i \\ 1 \end{pmatrix}.$

### 验证步骤

1. **验证特征方程**  
   $$A x = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix} \begin{pmatrix} i \\ 1 \end{pmatrix}
        = \begin{pmatrix} -1 \\ i \end{pmatrix}
        = i \begin{pmatrix} i \\ 1 \end{pmatrix}
        = \lambda x.$$

2. **计算分子与分母**  
   - 分子：  
     $$x^\top A x = \begin{pmatrix} i & 1 \end{pmatrix} \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix} \begin{pmatrix} i \\ 1 \end{pmatrix}
                = \begin{pmatrix} i & 1 \end{pmatrix} \begin{pmatrix} -1 \\ i \end{pmatrix}
                = -i + i = 0.$$

   - 分母：  
     $$x^\top x = \begin{pmatrix} i & 1 \end{pmatrix} \begin{pmatrix} i \\ 1 \end{pmatrix}
               = i^2 + 1^2 = -1 + 1 = 0.$$


3. **发现问题**  
   错误证明需要除以  $x^\top x$，但这里  $x^\top x = 0$，导致公式 **无法使用**。  
   因此证明**隐含假设了 $x^\top x \neq 0$ ，而复特征向量可能使该假设不成立。

---

# 习题 2

非奇异矩阵群包括 $A$ 和 $B$ 时也包括 $AB$ 和 $A^{-1}$。“乘积和逆仍在群中。” 以下哪些是群？

### a) 正定对称矩阵 $A$

正定对称矩阵 $A$ **不构成一个群**。

**反例：**  
取两个正定对称矩阵：
$$
A = \begin{bmatrix} 1 & 2 \\ 2 & 1 \end{bmatrix}, \quad
B = \begin{bmatrix} 2 & \frac{1}{2} \\ \frac{1}{2} & 1 \end{bmatrix}
$$

计算乘积：
$$
AB = \begin{bmatrix} 1 & 2 \\ 2 & 1 \end{bmatrix}
\begin{bmatrix} 2 & \frac{1}{2} \\ \frac{1}{2} & 1 \end{bmatrix} =
\begin{bmatrix} 2.5 & 1 \\ 1.5 & 1.5 \end{bmatrix}
$$

结果 $AB$ **不是对称矩阵**，因此不满足群的封闭性。

---

### b) 正交矩阵 $Q$

正交矩阵 $Q$ **构成一个群**。

**证明：**  
- 若 $A$ 正交，则 $A^T A = I$，所以 $A^{-1} = A^T$，即 $A^{-1}$ 也是正交的。
- 若 $A, B$ 正交，则：
  $$
  (AB)^T (AB) = B^T A^T A B = B^T I B = B^T B = I
  $$
  所以 $AB$ 也是正交的。

满足封闭性和逆元存在性，因此是群。

---

### c) 固定矩阵 $A$ 的所有指数 $e^{tA}$

所有形如 $e^{tA}$ 的矩阵 **构成一个群**。

**证明：**  
- 逆元：$(e^{pA})^{-1} = e^{-pA}$，仍为 $e^{tA}$ 形式。
- 封闭性：$e^{pA} e^{qA} = e^{(p+q)A}$，仍为 $e^{tA}$ 形式。

因此构成群。

---

### d) 行列式为 1 的矩阵 $D$

行列式为 1 的矩阵 $D$ **构成一个群**。

**证明：**  
- 若 $\det A = 1$，则 $\det(A^{-1}) = 1$（这个结论看2.5讲）。
- 若 $\det A = 1$，$\det B = 1$，则：
  $$
  \det(AB) = \det(A) \det(B) = 1 \cdot 1 = 1
  $$

满足群的性质，因此是群（即特殊线性群 $SL(n)$）。

这讲习题课其实意义不大，主要是加深大家对一些重要概念的理解，大家略看就行，不必深入理会！