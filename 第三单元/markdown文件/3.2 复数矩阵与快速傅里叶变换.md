之前我们曾经谈论过复数矩阵，但是对于它的运算与性质并没有进行展开，仅仅是在第二单元复习的时候讨论了一下。本节中我们介绍复数矩阵的运算等特征。并介绍一个重要的复数矩阵：傅里叶矩阵。其中重点介绍快速傅里叶变换，可以显著减小运算量。

# 复数矩阵
首先我们从简单的向量说起！
首先什么是复数向量，**“复数向量”指的是分量全部在复数域中的向量**，而不是“至少有一个分量是复数”。显然复数向量属于的n维复平面。那么对于复数向量，我们需要与实数矩阵区分出两点，第一点是模长的计算，第二点是内积的计算！
模长的计算，实数矩阵我们是这样求解的：$Z^TZ$，然后再开根号！而复数向量是得是先共轭再转置，这个在上一级证明对称矩阵性质一的时候说过！所以正确求解是：$\bar{Z}^TZ$，然后开根号！
比如复数向量$\begin{bmatrix}1\\i\end{bmatrix}$（这也是复数向量哦，因为1可以看为1+0i），那么他的模长就是$\begin{bmatrix}1&-i\end{bmatrix}\begin{bmatrix}1\\i\end{bmatrix}$,但是如果是$\begin{bmatrix}1&i\end{bmatrix}\begin{bmatrix}1\\i\end{bmatrix}$那得到的结果就是0，显然模长是零的只要是零向量！
同时，内积的求解，实数矩阵是$y^Tx$，而复数向量内积求解就是$\bar{y}^Tx$！
而他们都有一个专门的符号H，所以符号可以写为$Z^HZ$!那么$Z^HZ=|z_{1}|^2+|z_{2}|^2+\dots+|z_{n}|^2$

那么我们也需要对复数对称矩阵进行重新的认识了！
我们之前说对称矩阵的一个充要条件的$A^T=A$。而对于复数对称矩阵就得是$A^H=A$。显然对称矩阵为满足这个性质，对称轴元素得是实数！
举个复数对称矩阵的例子：$\begin{bmatrix}2&3+i\\3-i&5\end{bmatrix}$。而复数对称矩阵还是满足特征值都为实数（上一讲证明过），特征向量相互垂直的！
说到复向量正交，就是说有一组复数向量：$q_{1},q_{2},q_{3},\dots,q_{n}$，那么满足$q_{i}^Hq_{j}\begin{cases}0(i\ne j)\\1(i=j)\end{cases}$
那么他们这一组正交基可以组成一个矩阵$Q=\begin{bmatrix}q_{1},q_{2},q_{3},\dots,q_{n}\end{bmatrix}$，那么$𝑄^𝑇Q = I = 𝑄^𝐻Q$
而这样的矩阵我们称之为：酉矩阵。
自然**酉矩阵**有如下性质：$QQ^H=I$

# 傅里叶矩阵
说到酉矩阵，那么傅里叶矩阵就是其中最经典的一个！
傅里叶级数把周期函数（或信号）表示为不同频率的正弦、余弦之叠加：

$$
f(x)=a_0+a_1\cos x+b_1\sin x+a_2\cos 2x+b_2\sin 2x+\cdots
$$

当处理**有限长度**的数据集时，关键在于**离散傅里叶变换**。

> 在电气工程与计算机科学中，行列编号通常从 **0** 开始（而非 1），到 **n − 1** 结束。下文讨论傅里叶矩阵时，我们沿用此约定。

傅里叶矩阵定义为

$$
F_n=
\begin{pmatrix}
1 & 1 & 1 & \cdots & 1 \\
1 & w & w^2 & \cdots & w^{n-1} \\
1 & w^2 & w^4 & \cdots & w^{2(n-1)} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
1 & w^{n-1} & w^{2(n-1)} & \cdots & w^{(n-1)^2}
\end{pmatrix},
$$

其中

- $(F_n)_{j,k}=w^{jk},\quad j,k=0,1,\dots,n-1$；
- 复数 $w=e^{i\cdot 2\pi/n}$（因此 $w^n=1$）。
这个第二点的结论是怎么得来的呢，又是欧拉公式，由于这个知识点用到很多，所以我们还是来解释一下：只要记住一条最基本的欧拉公式：$e^{iθ} = cos θ + i sin θ$
把 θ 换成 2π/n，就得到$w = e^{i·2π/n} = cos(2π/n) + i sin(2π/n)$
它代表复平面上一个**幅角为 2π/n** 的单位向量（模长为 1，方向与正实轴夹角 2π/n）。
再把这个向量自乘 n 次，相当于把幅角放大 n 倍：
$w^n = [e^{i·2π/n}]^n = e^{i·2π} = cos(2π) + i sin(2π) = 1 + 0i = 1$
因此 w 就是“n 次单位根”——模 1、幅角 2π/n 的复数，自乘 n 次恰好回到 1。

该矩阵的列向量彼此正交大家可以验算证明；矩阵所有元素位于复平面的单位圆上，就是说矩阵所有元素模长都为1，这个大家也可以套用欧拉公式证明，$w^{jk} = [e^{i·2π/n}]^{jk} = e^{ikj·2π/n} = cos(kj2π/n) + i sin(kj2π/n)$，计算其模长就是1；将任一元素自乘 $n$ 次都得到 1，就是所任何元素n次方都是1，我们计算$(w^{jk})^n=(e^{ikj·2π/n})^n=e^{ikj·2π}=1$。
所以傅里叶矩阵是一个正交矩阵，乘以一个适当的系数就是一个标准正交矩阵！而傅里叶矩阵的作用就是记录下完成傅里叶变换过程的操作！

---

## 具体例子：$F_4$

取 $n=4$，则 $w=e^{2\pi i/4}=i$，于是

$$
F_4=
\begin{pmatrix}
1 & 1 & 1 & 1 \\
1 & i & i^2 & i^3 \\
1 & i^2 & i^4 & i^6 \\
1 & i^3 & i^6 & i^9
\end{pmatrix}
=
\begin{pmatrix}
1 & 1 & 1 & 1 \\
1 & i & -1 & -i \\
1 & -1 & 1 & -1 \\
1 & -i & -1 & i
\end{pmatrix}.
$$

对含 4 个数据点的向量做傅里叶变换，只需乘以 $F_4$。

验证可知 $F_4$ 的列正交（计算时记得取共轭），但列长为 2，因而 $F_4$ 并非酉矩阵。将每个元素除以 2 即可得到标准正交列的矩阵：

$$
\frac14 F_4^H F_4 = I.
$$
所以傅里叶矩阵的逆矩阵很好求，显然，他是一个性质优良的矩阵！

---
举个例子来看看傅里叶矩阵的妙处：
## 冲激信号示例

零时刻的冲激信号可表示为

$$
\begin{pmatrix}
1\\0\\0\\0
\end{pmatrix}.
$$

其傅里叶变换为

$$
F_4
\begin{pmatrix}
1\\0\\0\\0
\end{pmatrix}
=
\begin{pmatrix}
1\\1\\1\\1
\end{pmatrix}.
$$

> **结论**：单个冲激在所有频率上分量相等。不懂没关系，理解是一个变化的描述即可！当然如果你是通信专业的话就有关系了！

若再乘以 $F_4$ 并除以 4，即可回到原信号：

$$
\frac14 F_4
\begin{pmatrix}
1\\1\\1\\1
\end{pmatrix}
=
\frac14
\begin{pmatrix}
4\\0\\0\\0
\end{pmatrix}
=
\begin{pmatrix}
1\\0\\0\\0
\end{pmatrix}.
$$

由于 $\frac{1}{\sqrt{n}}F_n$ 是酉矩阵，因此“乘 $F_n$ 再除以 $n$”即完成逆变换。因为傅里叶矩阵 $F_{4}$​ 的逆矩阵恰好是 $\frac{1}{4}F_{4}^H​$，所以“再乘一次 $F_{4}$​ 再除以 4”就等于乘了逆矩阵，自然就把原来的信号还原了。

---

# 快速傅里叶变换（Fast Fourier Transform）

> 傅里叶矩阵可拆分为含大量零的子块；傅里叶本人可能未注意到。然而高斯发现了，却未意识到其重要性。(饶命，不是我评价的高斯和傅里叶，而是教授提到的一个史实！)

$F_n$ 与 $F_{2n}$ 之间存在一个优美的关系，其依据是

$$
w_{2n}^2 = w_n.
$$

因为$w_{n}=e^{2\pi i/n},w_{2n}=e^{2\pi i/2n}$,显然就是平方关系！记住这个结论，这将是我们推导快速傅里叶变换的关键！
于是

$$
F_{2n} =
\begin{bmatrix}
I & D \\
I & -D
\end{bmatrix}
\begin{bmatrix}
F_n & 0 \\
0 & F_n
\end{bmatrix}
P,
$$

下面我们来推导这个公式的由来！
其中 $D$ 是一个对角矩阵，D是$$\begin{bmatrix}1&&&&\\&w_{2n}&&\\&&w_{2n}^2\\&&&\dots.\\&&&w_{2n}^{n-1}\end{bmatrix}$$
$P$ 是一个 $2n \times 2n$ 置换矩阵：

$$
P =
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & \cdots \\
0 & 0 & 1 & 0 & 0 & \cdots \\
\vdots & \vdots & \vdots & \vdots & \vdots & \\
0 & 1 & 0 & 0 & \cdots & 0 \\
0 & 0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & 0 & \cdots & 1
\end{bmatrix}.
$$
那么我们这么来看：
$$F_{2n}x=
\begin{bmatrix}
I & D \\
I & -D
\end{bmatrix}
\begin{bmatrix}
F_n & 0 \\
0 & F_n
\end{bmatrix}
Px----(1)$$
x是任意的一个复数向量。P矩阵的作用就是把一个向量的偶数分量放到前面，奇数分量放到后面（注意是从0开始计数哦！）
先给符号 
长度为 $2n$ 的输入向量写成  
$$
{x}=(x_0,x_1,x_2,\dots,x_{2n-1})^{\!T}
$$
矩阵 P的作用P 只是把下标“偶数在前、奇数在后”重新排列：  
$$
P{x}= (x_0,x_2,x_4,\dots,x_{2n-2},\,x_1,x_3,x_5,\dots,x_{2n-1})^{\!T}
=\begin{bmatrix}\mathbf{x}_{\text{even}}\\[2pt]\mathbf{x}_{\text{odd}}\end{bmatrix},
$$
其中  
$$
{x}_{\text{even}}=(x_0,x_2,\dots,x_{2n-2})^{\!T},\quad
{x}_{\text{odd}}=(x_1,x_3,\dots,x_{2n-1})^{\!T}.
$$

2 两个 $n$ 点 FFT 同时作用把偶、奇两部分分别送进 $F_n$： 
$$
\begin{bmatrix}F_n&0\\[2pt]0&F_n\end{bmatrix}
\begin{bmatrix}\mathbf{x}_{\text{even}}\\[2pt]\mathbf{x}_{\text{odd}}\end{bmatrix}
=
\begin{bmatrix}F_n\mathbf{x}_{\text{even}}\\[2pt]F_n\mathbf{x}_{\text{odd}}\end{bmatrix}
\triangleq
\begin{bmatrix}\mathbf{y}_{\text{even}}\\[2pt]\mathbf{y}_{\text{odd}}\end{bmatrix}.
$$  
这一步得到两个长度为 $n$ 的向量 $\mathbf{y}_{\text{even}}$ 和 $\mathbf{y}_{\text{odd}}$。
3.对角矩阵 $D$ 是什么 
$$
D=\operatorname{diag}(1,\,w_{2n},\,w_{2n}^{2},\,\dots,\,w_{2n}^{\,n-1}).
$$  
它把 $\mathbf{y}_{\text{odd}}$ 的每个分量 $k$ 再乘一个相位 $w_{2n}^{k}$。

4.把结果拼回去
现在看（1）式右侧乘出来的结果： 
$$
\begin{bmatrix}I&D\\[2pt]I&-D\end{bmatrix}
\begin{bmatrix}\mathbf{y}_{\text{even}}\\[2pt]\mathbf{y}_{\text{odd}}\end{bmatrix}
=
\begin{bmatrix}\mathbf{y}_{\text{even}}+D\mathbf{y}_{\text{odd}}\\[2pt]
              \mathbf{y}_{\text{even}}-D\mathbf{y}_{\text{odd}}\end{bmatrix}.
$$  
把这两个 $n$ 维向量上下拼起来，就得到 $2n$ 维向量。

5.验证它就是 $F_{2n}\mathbf{x}$把 $F_{2n}$ 的 $(j,k)$ 元素写成 $w_{2n}^{\,jk}$，直接按定义乘 $\mathbf{x}$，会发现：  
- 当 $k$ 是偶数时，$w_{2n}^{\,j(2t)}=w_{n}^{\,jt}$ → 对应偶数部分正好等于 $F_n\mathbf{x}_{\text{even}}$；  
- 当 $k$ 是奇数时，$w_{2n}^{\,j(2t+1)}=w_{2n}^{\,j}\,w_{n}^{\,jt}$ → 对应奇数部分正好是 $w_{2n}^{\,j}(F_n\mathbf{x}_{\text{odd}})_t$。  

把这两部分合起来，和步骤 4 得到的 
$$\mathbf{y}_{\text{even}}\pm D\mathbf{y}_{\text{odd}}$$ 完全一致。因此  
$$F_{2n}\mathbf{x}
=
\begin{bmatrix}I&D\\[2pt]I&-D\end{bmatrix}
\begin{bmatrix}F_n&0\\[2pt]0&F_n\end{bmatrix}
P{x}$$

这就是（1）式。


换句话说：  P 把 x 拆成偶/奇；  
- 两个 $F_n$ 分别做 $n$ 点 FFT；  
- 再用 $\displaystyle\begin{bmatrix}I&D\\[2pt]I&-D\end{bmatrix}$ 做“蝶形合并”。  
每一步只有 $O(n)$ 工作量，于是 $2n$ 点变成 $2$ 个 $n$ 点外加 $O(n)$ 额外运算，递归下去就是 FFT。


因此，一个 $2n$ 点傅里叶变换 $F_{2n}\mathbf x$——原本看似需要
$$
(2n)^2 = 4n^2
$$

次运算——现在可以改用两次 $n$ 点傅里叶变换（共 $2n^2$ 次运算）加上两次非常简单的矩阵乘法（大约 $n$ 次乘法）来完成。矩阵 $P$ 先把向量的偶数下标分量 
$$x_0,x_2,x_4,\dots$$ 选出来排在前面，然后排奇数下标分量——这一计算可以非常迅速地进行。

于是，我们可以通过对向量先分出奇偶分量，再分别对两半各做一次 $32$ 点傅里叶变换，最后通过一个涉及对角矩阵 $D$ 的过程把两部分重新组合，来完成对一个长度为 $64$ 的向量的傅里叶变换。

$$
D =
\begin{bmatrix}
1 & & & \\
  & w & & \\
  & & w^2 & \\
  & & & \ddots \\
  & & & & w^{\,n-1}
\end{bmatrix}.
$$

当然，这两个 $F_{32}$ 又可以各自拆成两个 $F_{16}$，依此类推。最终，我们不再用大约$\frac12 n^2$次运算去乘 $F_n$，而是只用大约

$$
\frac12 n \log_2 n
$$

次运算就得到同样的结果。

一个典型的情况是 $$n = 1024 = 2^{10}$$。直接乘 $F_n$ 需要超过一百万次计算。快速傅里叶变换只需

$$
\frac12 n \log_2 n = 5 \cdot 1024 = 5120
$$

次计算，快了 $200$ 倍！
这之所以可行，仅仅因为傅里叶矩阵是列正交的特殊矩阵。
>内心os：这节课过于烧脑，推导以及理解起来太难，可以说FFT是这门线性代数课中最难的部分，FFT的应用十分广泛，在科学计算中更是十分常用，大家如果要理解，任重道远，希望大家拜读教材，进一步理解！


在下一讲中，我们将回到纯实数，并学习在应用中最常出现的正定矩阵。

# 讨论课
我们有一个可对角化矩阵A：$$\begin{bmatrix}2&1-i\\1+i&3\end{bmatrix}$$
找出这个矩阵的特征值矩阵和特征向量并写出他的对角化形式！

首先求解特征值：$$\begin{bmatrix}2-\lambda&1-i\\1+i&3-\lambda\end{bmatrix}$$
那么得到等式：$$(2-\lambda)(3-\lambda)-(1+i)(1-i)$$
解得特征值为1或者4！
当特征值为1时，得到：$$\begin{bmatrix}1&1-i\\1+i&2\end{bmatrix}\begin{bmatrix}v_{1}\\v_{2}\end{bmatrix}=0$$
得到解为：$\begin{bmatrix}1-i\\-1\end{bmatrix}$
当特征值为4时，得到：$$\begin{bmatrix}-2&1-i\\1+i&-1\end{bmatrix}\begin{bmatrix}v_{1}\\v_{2}\end{bmatrix}=0$$
得到解为：$\begin{bmatrix}1\\1+i\end{bmatrix}$
那么我们得到了特征值矩阵为：$$\begin{bmatrix}1&0\\0&4\end{bmatrix}$$
特征向量矩阵是：$$\begin{bmatrix}1-i&1\\-1&1+i\end{bmatrix}$$
而要求出他的对角化形式，需要特征向量矩阵的逆矩阵！而这个矩阵差一点能够成为**酉矩阵**，所以我们让他成为**酉矩阵**，那么就是$\frac{1}{\sqrt{ 3 }}\begin{bmatrix}1-i&1\\-1&1+i\end{bmatrix}$，而他的逆矩阵就是他的转置共轭矩阵为：$\frac{1}{\sqrt{ 3 }}\begin{bmatrix}1+i&-1\\1&1-i\end{bmatrix}$
所以对角化形式是：$\frac{1}{\sqrt{ 3 }}\begin{bmatrix}1-i&1\\-1&1+i\end{bmatrix}\begin{bmatrix}1&0\\0&4\end{bmatrix}\frac{1}{\sqrt{ 3 }}\begin{bmatrix}1+i&-1\\1&1-i\end{bmatrix}$!

# 习题课
# 问题一
求解$F_{2}$
首先我们知道的初始是$\begin{bmatrix}1&1\\1&w\end{bmatrix}$
而此时$w=e^{i2\pi/2}=e^{i\pi}=cos(\pi)+i\sin(\pi)=-1$
所以为$\begin{bmatrix}1&1\\1&-1\end{bmatrix}$

# 问题二
找出用于以下分解的矩阵 $D$ 和 $P$：

$$
\begin{bmatrix} I & D \\ I & -D \end{bmatrix}
\begin{bmatrix} F_2 & 0 \\ 0 & F_2 \end{bmatrix} P
= F_4
$$

然后通过乘法验证你的答案。

---

### 解答  
我们在上一题中计算得出：

$$
F_2 = \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}
$$

矩阵 $D$ 我们套用公式，求解$w_{2n}=e^{i2\pi/4}=cos\left( \frac{\pi}{2} \right)+i\sin\left( \frac{\pi}{2} \right)=i$

$$
D = \begin{bmatrix} 1 & 0 \\ 0 & i \end{bmatrix}
$$
而 $-D$ 则包含另外两个根（即 $-1$ 和 $-i$）。
矩阵 $P$ 是一个置换矩阵，它将输入向量的偶数分量排在前面。对于 $F_4$，这意味着将第 $1$ 个和第 $2$ 个分量交换位置：

$$
P \begin{bmatrix} x_0 \\ x_1 \\ x_2 \\ x_3 \end{bmatrix}
= \begin{bmatrix} x_0 \\ x_2 \\ x_1 \\ x_3 \end{bmatrix}
$$

因此：

$$
P = \begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

最后，我们通过乘法验证结果：

$$
\begin{bmatrix}
I & D \\
I & -D
\end{bmatrix}
\begin{bmatrix}
F_2 & 0 \\
0 & F_2
\end{bmatrix}
P
=
\begin{bmatrix}
1 & 0 & 1 & 0 \\
0 & 1 & 0 & i \\
1 & 0 & -1 & 0 \\
0 & 1 & 0 & -i
\end{bmatrix}
\begin{bmatrix}
1 & 1 & 0 & 0 \\
1 & -1 & 0 & 0 \\
0 & 0 & 1 & 1 \\
0 & 0 & 1 & -1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

计算后得到：

$$
 \begin{bmatrix}
1 & 1 & 1 & 1 \\
1 & i & -1 & -i \\
1 & -1 & 1 & -1 \\
1 & -i & -1 & i
\end{bmatrix}
= F_4
$$



