
## 消元法 
消元是计算机软件中求解线性方程组最常用的技术，与我们小学5年级学习的二元一次方程组的消元如出一辙。当矩阵 $A$ 可逆时，它能找到一个解 $x$，使得 $Ax = b$ 成立。 在课堂上使用的例子如下： $$ A = \begin{bmatrix} 1 & 2 & 1 \\ 3 & 8 & 1 \\ 0 & 4 & 1 \end{bmatrix}, \quad b = \begin{bmatrix} 2 \\ 12 \\ 2 \end{bmatrix} $$ 位于矩阵 $A$ 左上角的数字 **1** 被称为第一个主元（pivot）。我们复制第一行，并将这一行中的数字乘以适当的值（在这个例子中是 **3**），然后从第二行中的相应数字中减去这些值。这样，第二行的第一个数字变为 **0**，即我们消去了第二行第一列的 **3**。 下一步是在第三行第一列处得到另一个 **0**；在这个例子中已经满足条件了。 第二个主元是现在出现在第二行第二列的值 **2**。我们使用一个乘数（在这个例子中是 **2**）来乘以第二行，从而消除第三行第二列中的 **4**。第三个主元就是现在在第三行第三列的 **5**。 我们从一个可逆矩阵 $A$ 开始，最终得到了一个上三角矩阵 $U$。矩阵 $U$ 的左下部分全为零，而主元 **1、2、5** 都位于对角线上。例如： $$ A = \begin{bmatrix} 1 & 2 & 1 \\ 3 & 8 & 1 \\ 0 & 4 & 1 \end{bmatrix} \rightarrow \begin{bmatrix} 1 & 2 & 1 \\ 0 & 2 & -2 \\ 0 & 4 & 1 \end{bmatrix} \rightarrow U = \begin{bmatrix} 1 & 2 & 1 \\ 0 & 2 & -2 \\ 0 & 0 & 5 \end{bmatrix} $$ 接下来，我们对向量 $b$ 进行同样的乘法和减法操作。例如，我们将第一位的 **2** 乘以 **3**，然后从 **12** 中减去，得到第二位的 **6**。 手工计算时，可以通过将向量 $b$ 作为最后一列附加到矩阵 $A$ 上，形成增广矩阵来实现这一点。消元法将原方程 $Ax = b$ 转换为新的方程 $Ux = c$。在上面的例子中： $$ U = \begin{bmatrix} 1 & 2 & 1 \\ 0 & 2 & -2 \\ 0 & 0 & 5 \end{bmatrix}, \quad c = \begin{bmatrix} 2 \\ 6 \\ -10 \end{bmatrix} $$ 方程 $Ux = c$ 很容易通过**回代**（back substitution）求解。在我们的例子中，$z = -2$, $y = 1$, $x = 2$。这也是原始系统 $Ax = b$ 的解。其实在这里我们把U的主对角线元素的乘积看做是A的行列式，如果行列式的结果为0，那么矩阵不可逆，是一个奇异矩阵！
#### 注意事项： 
- **行列式**：矩阵 $U$ 的行列式是所有主元的乘积。（这个我们暂时不理解后续会说明的）
- **主元不能为 0**：如果某个主元位置为零，我们需要交换该行与下面的一行，以获得一个非零值。（就是说在消元过程中我们遇到主元位置为0的情况，可以通过换行来达到消元目的）
- **不可逆矩阵**：如果主元位置为零且下方没有非零值，则矩阵 $A$ 不可逆，无法找到唯一解。也暗示了一个定理，当一个矩阵无法被换成三角矩阵，说明是不可逆矩阵，也就是奇异矩阵。
## 消元矩阵 
一个 $3 \times 3$ 矩阵与一个 $3 \times 1$ 列向量的乘积是一个$3 \times 1$ 列向量，它是矩阵列的线性组合。 一个 $1 \times 3$ 行向量与一个 $3 \times 3$ 矩阵的乘积是一个 $1 \times 3$ 行向量，它是矩阵行的线性组合。（这个是一个定理，证明起来比较复杂，大家记住就好，我们在之前的章节提到过这个定理）我们可以使用矩阵乘法来表示消元步骤。例如，从矩阵 $A$ 的第二行减去第一行的 **3 倍**： $$ \begin{bmatrix} 1 & 0 & 0 \\ -3 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} \begin{bmatrix} 1 & 2 & 1 \\ 3 & 8 & 1 \\ 0 & 4 & 1 \end{bmatrix} = \begin{bmatrix} 1 & 2 & 1 \\ 0 & 2 & -2 \\ 0 & 4 & 1 \end{bmatrix} $$
这个是怎么做到的呢。其实有很多话要讲，其实下面的解释就是提前讲解了一部分的矩阵乘法，但是我还是推荐大家暂时以向量的视角去看待这个结果矩阵的形成：
#### 矩阵的乘法本质
首先对于前面我们讲到过的法一与法二这两个乘法规则，一个是以列向量的角度去看的，一个是以向量乘积为基础的拆解步骤，今天我们以矩阵视角去看待这个问题。

首先两个矩阵相乘，当把前一个矩阵看为变换的主体的话，那么后一个矩阵就是对前一个矩阵的列进行线性组合，组合的法则是什么呢：后一个矩阵的第一列的3个元素，分别对前一个矩阵的三个列向量进行相乘后求加得到结果矩阵的第一列。比如上面的例子，后面矩阵的第一列元素1，3，0分别乘以前一个矩阵的第一，第二，第三个列向量相加后是不是等于结果矩阵的第一列。同样，后一个矩阵的第二列的3个元素，分别对前一个矩阵的三个列向量进行相乘后求加得到结果矩阵的第二列。以此类推！

然后两个矩阵相乘，当把后一个矩阵看为变换的主体的话，那么前一个矩阵就是对后一个矩阵的行进行线性组合。法则是：前一个矩阵的第一行的三个元素，分别对后一个矩阵的三个行向量进行相乘后求和得到结果矩阵的第一行。比如上面的例子，前面矩阵的第一行三个元素1，0，0分别乘以后一个矩阵的三个第一第二第三个行向量后相加得到结果矩阵的第一行。后面的以此类推！

知道这个本质之后是不是对前面章节讲到的乘法法则三，四，五都有一个理解了呢，无非是拆分后的计算便利罢了！

至于这个法则的证明很复杂，我们不必了解，但是我有一个很直观的理解。以后一个矩阵为主体为例子，就是三个向量组成的矩阵，现在有另外一个矩阵对三个向量进行线性线性组合，而组合的法则如上。

我们说回消元矩阵，用于消去第 $m$ 行第 $n$ 列元素的消元矩阵记作 $E_{mn}$。上述计算过程是从 $A$ 到 $E_{21}A$。引导至 $U$ 的三个消元步骤是： $$ E_{32}(E_{31}(E_{21}A)) = U $$ 其中 $E_{31} = I$，所以： $$ E_{32}(E_{21}A) = U $$ 矩阵乘法是符合结合律的，因此也可以写成： $$ (E_{32}E_{21})A = U $$ 乘积 $E_{32}E_{21}$ 告诉我们如何从 $A$ 到达 $U$，而它的逆矩阵告诉我们如何从 $U$ 回到 $A$。 如果我们解 $Ux = EAx = Eb$，那么 $Ax = b$ 也成立。这就是为什么消元法有效的原因：所有步骤都可以被逆转。 所以我们要有这么一个思想：
就是一个矩阵是可以记录下对另外一个矩阵的一系列操作的。
## 置换矩阵（注意与转置矩阵区别开）
一个置换矩阵用于交换矩阵的两行。例如： $$ P = \begin{bmatrix} 0 & 1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix} $$ 矩阵 $PA$ 的第一行和第二行分别是矩阵 $A$ 的第二行和第一行。置换矩阵是通过对单位矩阵的行进行交换构造而成的(通过上面介绍的定理相信不难理解)。 同样要交换矩阵的列，可以从右边乘以一个置换矩阵（如 $AP$）。 请注意，矩阵乘法不是可交换的： $$ PA \neq AP $$
## 逆矩阵 
我们有一个矩阵： $$ E_{21} = \begin{bmatrix} 1 & 0 & 0 \\ -3 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} $$ 它表示从第二行减去第一行的 **3 倍**。 为了“撤销”这个操作，我们必须使用其逆矩阵给第二行加上第一行的 **3 倍**： $$ E_{21}^{-1} = \begin{bmatrix} 1 & 0 & 0 \\ 3 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} $$ 实际上： $$ E_{21}^{-1} E_{21} = I $$
大家可以看出，逆矩阵就是消元法的反向进行。

所以这里就解释了为什么一个矩阵是否有逆矩阵与一个矩阵是否是奇异矩阵相等价。因为如果一个矩阵是奇异的，那么就不存在另外一个矩阵帮他到达等式的右边，自然就没有从等式右边回左边的方法了！

所以通过这一讲的学习，我们需要了解在矩阵乘法视角下的消元法，消元矩阵的含义，掌握消元法，以及消元矩阵的应用。第一点，无非就是通过简化矩阵然后回代求解，但是消元的过程是与矩阵的乘法息息相关的。第二点消元，我们在第一点讲到了矩阵乘法，没错消元矩阵一个重要含义是记录了对另外一个矩阵的变换过程，矩阵乘法就是变换的法则。同时消元法在后续经常使用大家要熟练。最后，消元矩阵在求解逆的过程中是至关重要的！
## 5.习题课：
## 问题 1：
在以下的二乘二线性方程组中，当使用消元法时，应该从第二个方程中减去第一个方程的多少倍？将这个方程组转换为矩阵形式，应用消元（主元是什么？），并用回代法找到一个解。尝试检查你的工作后再查看答案。
$2x + 3y = 5$
$6x + 15y = 12$

## 问题 2：（来自《线性代数导论》Strang 的 2.3#29）
找出能将“帕斯卡矩阵”化简为更小帕斯卡矩阵的三角矩阵 E：
$$ 
E \begin{bmatrix}
1 & 0 & 0 & 0 \\
1 & 1 & 0 & 0 \\
1 & 2 & 1 & 0 \\
1 & 3 & 3 & 1
\end{bmatrix} =
\begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 1 & 1 & 0 \\
0 & 1 & 2 & 1
\end{bmatrix}
$$
哪个矩阵 M（通过多个 E 相乘）可以将帕斯卡矩阵完全化简为单位矩阵 I？

# 关于矩阵消元的练习解答 
## 问题 2.1 解答： 
对于方程组： $2x + 3y = 5$ $6x + 15y = 12$ 首先将方程转换为增广矩阵形式： $$ \left[ \begin{array}{cc|c} 2 & 3 & 5 \\ 6 & 15 & 12 \end{array} \right] $$ 为了使用消元法，我们需要从第二个方程中减去第一个方程的适当倍数。注意到第二个方程的第一个系数6是第一个方程的第一个系数2的三倍，所以我们需要从第二行减去第一行的3倍。 执行消元步骤： $$ \left[ \begin{array}{cc|c} 2 & 3 & 5 \\ 0 & 6 & -3 \end{array} \right] $$ 现在我们得到了一个上三角矩阵。主元分别是2和6。 接下来，通过回代法求解： $y = \frac{-3}{6} = -\frac{1}{2}$ $x = \frac{5 - 3(-\frac{1}{2})}{2} = \frac{5 + \frac{3}{2}}{2} = \frac{\frac{13}{2}}{2} = \frac{13}{4}$ 所以解为：$x = \frac{13}{4}, y = -\frac{1}{2}$。
## 问题 2.2 解答： 
给定帕斯卡矩阵及其化简目标： $$ E \begin{bmatrix} 1 & 0 & 0 & 0 \\ 1 & 1 & 0 & 0 \\ 1 & 2 & 1 & 0 \\ 1 & 3 & 3 & 1 \end{bmatrix} = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 1 & 1 & 0 \\ 0 & 1 & 2 & 1 \end{bmatrix} $$ 要找到矩阵 $E$，我们需要消除特定位置上的元素。在这个例子中，我们需要让第二行的第一个元素变为0，第三行的前两个元素变为0，第四行的前三个元素变为0。 为此，我们可以构建以下消元矩阵 $E$： $$ E = \begin{bmatrix} 1 & 0 & 0 & 0 \\ -1 & 1 & 0 & 0 \\ -1 & -1 & 1 & 0 \\ -1 & -2 & -1 & 1 \end{bmatrix} $$
其实这个矩阵的构建并不难，把后一个矩阵看为主体，与结果矩阵比，第一行不变，所以第一行是1，0，0，0。那么第二行似乎只需要用第二行减去第一行就可以，后面的同样这样去观察即可！

这个矩阵 $E$ 可以将原始帕斯卡矩阵转换为目标形式。要完全化简为单位矩阵 I，我们需要继续应用多个类似的消元步骤，直到所有非对角线元素都变为0。 例如，假设我们已经应用了上述 $E$，得到中间结果，然后进一步应用其他消元矩阵 $E_{ij}$ 直到达到单位矩阵 $I$。