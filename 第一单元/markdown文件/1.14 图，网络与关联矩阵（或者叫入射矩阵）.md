首先这一讲的内容可以说是应用数学中最重要的内容，他在多个理工科的应用十分常见！比如strang教授参加了一个化学的学生会议，然后在这个会议上，一些化学家为了研究复杂的化学反应，把一些参与的分子，元素集成为输入矩阵，而输出部分的元素和分子集成为结果矩阵，通过线性代数的化简去研究这些复杂的化学反应！比如，我们把输入矩阵进行消元，就知道是哪些元素参与了复杂反应！接下来我们就来说说这些伟大的应用模型！

# 图与关联矩阵
现在我们给出一个无向图：
![[Pasted image 20250722101420.png]]
而我们给每一条边加上箭头表明方向，并且为每一条边编号后我们会得到：
![[Pasted image 20250722101617.png]]

那么现在我们需要用矩阵去描述这个图片，而这样的矩阵我们叫做关联矩阵：
$\begin{bmatrix}-1&1&0&0\\0&-1&1&0\\-1&0&1&0\\-1&0&0&1\\0&0&-1&1\end{bmatrix}$，怎么看不懂，那么我来向大家说明这个矩阵是怎么填写的！
首先，每一列代表一个节点，每一行代表一条边！那么每一条边从哪个节点出发那个节点对应值是-1，到哪个节点那个节点值就是1。其他值为0。那么我们可以这么描述一下矩阵：![[屏幕截图 2025-07-22 151739.png]]
>值得注意的是：第三行等于第一行加上第二行，第4行等于第三行加第5行。而当我们把视角放到图中，发现这正是符合有向图的规则的！想这样的，我们在图中称为一个循环，也称为环！

# 关联矩阵的信息与现实意义探索
我们已经把一个图的信息迁移到一个矩阵上了！但是这个矩阵有许多信息值得去探索，他的零空间，左零空间，列空间，行空间有什么现实意义，他的秩，维度又能反应什么数学定理！下面我们以一个现实场景电势与电流为基础去讨论关联矩阵的额外一些信息！

首先一个矩阵A$\begin{bmatrix}-1&1&0&0\\0&-1&1&0\\-1&0&1&0\\-1&0&0&1\\0&0&-1&1\end{bmatrix}$把图的节点表示了出来，以及记录下了各个边的方向！
再此之前我们看看这个矩阵的秩是多少，很明显是3，the rank = 3！（计算过程就不赘述了）不过这个矩阵的秩，也就是列空间的维度，具体的现实意义似乎没有明显表露出来，我们也不用深入探究，毕竟我们不是学物理的，也不是学应用数学的！
#### （1）现在我们先来探索矩阵的零空间：
AX=0，得到：$\begin{bmatrix}-1&1&0&0\\0&-1&1&0\\-1&0&1&0\\-1&0&0&1\\0&0&-1&1\end{bmatrix}\begin{bmatrix}x_{1}\\x_{2}\\x_{3}\\x_{4}\end{bmatrix}=\begin{bmatrix}0\\0\\0\\0\end{bmatrix}$。现在我们引入第一个现实意义，我们假设X中的各个分量代表着每一个节点的电势（大家如果学习过高中物理，大家知道电势差就是电压产生的基础！）。矩阵每一列代表节点，而X就是去操作每一列的，也就是操作每一个节点的，而且操作结果是受矩阵的数值约束，也就是受边的方向约束的，AX的结果就是各个节点之间的电势差，我们从化简的结果也可以看出：$\begin{bmatrix}x_{2}-x_{1}\\x_{3}-x_{2}\\x_{3}-x_{1}\\x_{4}-x_{1}\\x_{4}-x_{3}\end{bmatrix}$，这就是代表着各个节点之间的电势差！所以我们可以这么理解这个矩阵方程AX=0：当各个节点电势差为0的时候，各个节点的电势是怎么样的？
我们想要解出x的基并不困难，得到$X=C\begin{bmatrix}1\\1\\1\\1\end{bmatrix}$，也就意味着各个点的电势相等时才会使得电势差为0！我们也可以得出结论，A矩阵的零空间的维度是1，他的基是$\begin{bmatrix}1\\1\\1\\1\end{bmatrix}$。

#### （2）继续探索矩阵的左零空间：
我们说过左零空间就是矩阵转置的空间。那么我们有$A^Ty=0$，那么得到：$\begin{bmatrix}-1&0&-1&-1&0\\1&-1&0&0&0\\0&1&1&0&-1\\0&0&0&1&1\end{bmatrix}\begin{bmatrix}y_{1}\\y_{2}\\y_{3}\\y_{4}\\y_{5}\end{bmatrix}=\begin{bmatrix}0\\0\\0\\0\end{bmatrix}$。那么现在矩阵的行代表节点，列代表边。y中的分量对图的边进行操作，边之间的组合，结果就可以代表每个边的电流（直接这么想是十分抽象的，我估计那些物理学家也是已经十分了解电学方面的性质以及离散数学方面图的知识反推过来的），从化简结果来看也是可以理解的：$\begin{bmatrix}-y_{1}-y_{3}-y_{4}\\y_{1}-y_{2}\\y_{2}+y_{3}-y_{5}\\y_{4}+y_{5}\end{bmatrix}$，这就代表着各个边之间流过的电流大小总和。而y他本身代表就是对于边的电流流出大小，顺着边的方向的电流就是正数，否则就是负数！（如果你对高中物理电学部分理解深刻的话）！我们可以解出左零空间的基通过常规的数值线性代数的方法，但是我们在这里从现实意义的角度出发去求他的基。首先，是否记得基尔霍夫电流定律（大概率是不记得的，着应该是在高中物理教程中扩展知识的内容，如果不是考试内容，我们印象就不会那么深刻了），简单说基尔霍夫电流定律就是：从节点流出的所有支路电流的代数和为零，沿环路方向的所有地段电压的代数和为零。（不要纠结为什么，我们又不是在学物理，对应着下面的计算就可以了）
现在我们把图放下面来对比着看：![[Pasted image 20250722101617.png]]
首先我们知道矩阵的秩为三，那么在数值求解时，一定是有两个数赋值为0，那么我们先得到：$\begin{bmatrix}?\\?\\?\\0\\0\end{bmatrix}$,然后当1边流出1单位电流时，顺着节点2使得2边也流经了1单位电流，为了符合基尔霍夫电流定理，3边流经-1单位电流。那么为$\begin{bmatrix}1\\1\\-1\\0\\0\end{bmatrix}$。另外一个基也是如此：$\begin{bmatrix}0\\0\\1\\-1\\1\end{bmatrix}$,就这两个基（m-r=2）！当然，我们也可以通过这个方法解得其他解如：$\begin{bmatrix}1\\1\\0\\-1\\1\end{bmatrix}$，但是他就不是基了！而当我们$A^Ty=f$时，意味着有外接电源！因为在$A^Ty=0$中，他们各边的电流是平衡的为0（这符合常理，在一个没有外界影响的体系中，电流流经总和是为0的），而有了外界电源后就改变为 f 了！

既然如此，我们可以得到一个关于电流电势的总结：

X = X₁, X₂, X₃, X₄                                                     Aᵀy = 0 （基尔霍夫电流定律） 
（节点电势）                                                             ↑
	      $\Big\downarrow$ e = Ax                                                   ↑  Aᵀy
$x_{2}-x_{1}\dots etc$                    y = Ce                            $y_{1},y_{2},y_{3},y_{4}$
电压                               $\rightarrow$    $\rightarrow$                            各个边上的电流
                    欧姆定律
那么我们可以得到的是：$A^TCAx =0$这是没有外接电源的情况，如果外界电源就会有：$A^TCAx =f$

#### （3）我们来看看矩阵的列空间
其实没什么信息，秩是3，列空间维度是3，没有什么值得一讲的地方！或者说他值得一讲的地方需要介绍行空间时一起说（在列空间中，独立的列对应的节点是不成环的）！

#### （4）矩阵的行空间
就是转置矩阵的列空间，很明显，他的秩是3，也就是有三列是独立的，而独立的三列对应的边是1，2，4。有没有发现这三条边刚好连接了所有点！翻过来，矩阵中不独立的列，他们对应的边是可以形成环的！也可以说在列空间中，独立的列对应的节点是不成环的！

而没有成环的节点与边连接起来，我们不叫图，叫：树！

#### （5）观察矩阵的秩，我们可以得到与图之间的关系(欧拉公式)：
首先，毫无疑问的是m是边数，n是节点数，r是矩阵的秩，而通常在图中$r=n-1$，为什么会这样子呢，我们在（4）中说过，独立的列是不成环的，无论是在矩阵还是在转置矩阵中！那么在图中有n个节点，想要n个节点都不成环，必须要有n-1条边独立不成环！所以$r=n-1$。然后图中的环数是等于$m-r$的，因为m代表边，而 r 在转置矩阵中代表独立不成环的边，他们的差是剩下的不独立的边，不独立的边每一条都可以与独立的边成环！所以环数等于$m-r$！那么我们可以得到：$m-r=m-(n-1)$。就是:回路数=边数−(节点数−1)。整理后得到：节点数−边数+回路数=1！这在所以的图中都适用！而整理后的公式就是著名的欧拉公式，这个伟大的拓扑事实在任何图中都成立！

# 讨论课
我们有一个图：
![[Pasted image 20250723121536.png]]
现在我们需要把他信息转到一个矩阵A上！那么完成下面几个事情：
（1）矩阵A是怎么样的？
（2）求矩阵A的零空间与$A^T$的零空间的基？
（3）求矩阵$AA^T$的迹？
解答：
（1）：$\begin{bmatrix}-1&1&0&0&0\\0&-1&1&0&0\\-1&0&1&0&0\\0&-1&0&1&0\\0&0&0&-1&1\\0&0&1&0&-1\end{bmatrix}$。

（2）：他们的零空间，既可以运用数值线性代数的方法求解，也可以用我们这一讲说的电势的方法来求解！我们就以后者来讲解！首先矩阵Ax=0，就是电势差的要求为0，那么求解出零空间的基是：$c\begin{bmatrix}1\\1\\1\\1\\1\end{bmatrix}$。而左零空间的基，就是要求电流总和为0。以图为依据，得到两个基是$\begin{bmatrix}1\\1\\-1\\0\\0\\0\end{bmatrix}$和$\begin{bmatrix}0\\-1\\0\\1\\1\\1\end{bmatrix}$！

（3）首先矩阵的迹是指方阵的主对角线上元素的和，所以迹的第一只会出现在方阵中！
而$AA^T$就是一个方阵！而$AA^T$ 的迹就是 **矩阵 A 中所有元素的平方和**(从矩阵乘法列乘以行就可以看出来！)。由于矩阵A的元素不是1，-1就是0，那么我们可以求出矩阵的迹就是2+3+3+2+2=12

# 习题课
# 问题一：
![[Pasted image 20250723205944.png]]
为上图所示的方形图写出其 4×4 的关联矩阵 A。（提示：第一行在第 1 列为 -1，第 2 列为 +1。）  
哪些向量 (x₁, x₂, x₃, x₄) 属于 A 的零空间（nullspace）？你如何知道 (1, 0, 0, 0) 不在 A 的行空间（row space）中？

解答：
可知该矩阵为$A=\begin{bmatrix}-1&1&0&0\\0&-1&1&0\\0&0&1&-1\\-1&0&0&1\end{bmatrix}$，而A的零空间的向量一定是：x₁,=x₂= x₃= x₄（这应该无需再多说了）！而我们如何知道(1, 0, 0, 0)不再A的行空间中呢，最简单明了的方法就是算出行空间的基。但是我们在这里要强调其他的方法，也是我们之前在讲子空间的时候遗漏的内容！就是：行空间中的所有向量与零空间中所有的向量正交（乘积为0），而列空间中所有向量与左零空间的所有向量正交！为什么呢，证明如下：
行空间就是有矩阵行向量张成的空间，而零空间是AX=0中所有的X解张成的空间！而在方程AX=0中，其实是$AX=\begin{bmatrix}0\\.\\.\\.\\.\end{bmatrix}$,那么以矩阵乘法的视角去看（列乘以行）就是矩阵A中的第一行乘以X得到的第一个0，以此类推得到。所以说明行空间中的所有向量与零空间中所有的向量正交！同样列空间中所有向量与左零空间的所有向量正交！
把视角放回我们的题目，由于向量(1, 0, 0, 0)不与(x₁, x₁, x₁, x₁) 正交，所以他不属于行空间！

# 问题二：
继续使用问题一中的网络，假设电导矩阵为：
$\begin{bmatrix}1&0&0&0\\0&2&0&0\\0&0&2&0\\0&0&0&1\end{bmatrix}$，通过矩阵乘法计算 $A^TCA$。  
对于 f=(1,0,−1,0)，求方程 $A^TCAx$=f 的一个解。  
请在上述方形图上标出此时的电势 x 和电流 y=−CAx，其中电流源 f 从节点 1 流入，从节点 3 流出。

解答：$A^TCA=\begin{bmatrix}-1&0&0&-1\\1&-1&0&0\\0&1&1&0\\0&0&-1&1\end{bmatrix}\begin{bmatrix}1&0&0&0\\0&2&0&0\\0&0&2&0\\0&0&0&1\end{bmatrix}\begin{bmatrix}-1&1&0&0\\0&-1&1&0\\0&0&1&-1\\-1&0&0&1\end{bmatrix}=\begin{bmatrix}2&-1&0&-1\\-1&3&-2&0\\0&-2&4&-2\\-1&0&-2&3\end{bmatrix}$，
求解$A^TCAx$=f ，我们写出一个增广矩阵：$\left[\begin{array}{cccc|c}2&-1&0&-1 & 1 \\ -1&3&-2&0 & 0 \\ 0&-2&4&-2 & -1\\-1&0&-2&3&0\end{array}\right]$，然后我们通过数值线性代数求解得到特解为：$\begin{bmatrix} \frac{3}{4}\\ \frac{1}{4} \\ 0 \\\frac{1}{4} \end{bmatrix}$。而我们可以得到的是y = −CAx，**加负号是为了让电流方向与“电压降”方向一致**，符合物理直觉（电流从高电势流向低电势），我们在上面讲解的时候没加是为了简便。那么我们计算y = $\begin{bmatrix}1&-1&0&0\\0&2&-2&0\\0&0&-2&2\\1&0&0&-1\end{bmatrix}\begin{bmatrix} \frac{3}{4}\\ \frac{1}{4} \\ 0 \\\frac{1}{4} \end{bmatrix}$,得到y=$\begin{bmatrix} \frac{1}{2}\\ \frac{1}{2} \\ \frac{1}{2} \\\frac{1}{2} \end{bmatrix}$。这个时候我们的各边电流和各边电势都出来的。在图中标出即可！