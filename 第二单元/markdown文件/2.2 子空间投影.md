# 向量的投影
首先我们来看最简单的一维的投影。看下图：（图不好看）
![[../../image/屏幕截图 2025-07-27 181121.png]]
p 即为 b 在 a 上的投影，写做p = xa（x 为倍数）。而这时，它们之间的差值是 b-p（向量减法）也可以说是b与a之间的偏移量，我们称之为 e 。那么现在的问题就是这个投影有什么特点呢？很明显，联系我们上节所学习的正交的概念，这个e是与a正交的。所以我们可以得到的是：$a^Te=a^T(b-p)=a^T(b-xa)=0$，然后我们化简得到：$a^T(b-xa)=0\rightarrow a^Tb-a^Txa=0\rightarrow a^Tb=a^Txa\rightarrow x=\frac{a^Tb}{a^Ta}$，（注意，在线性移动等式两边内容不可以像标量那样已过去当分母，而是乘以逆，不过在这里等式右边是标量！）代入x到p=xa或者说是p=ax中得到：p=$a\frac{a^Tb}{a^Ta}$，转换一下得到的是：$p=\frac{aa^T}{a^Ta}b$。那么可以发现p 的形式中含有 b，那么就说明投影是通过前面系数(矩阵形式)来完成的，我们把它称为：投影矩阵。也就是说在这个例子中投影矩阵是：$\frac{aa^T}{a^Ta}$。
>tips：（注意这里的 $a𝑎^𝑇$与$𝑎^𝑇𝑎$是不同的，当 a 是列向量时，前者是一个矩阵，后者是一个具体数字。）

考考大家，投影矩阵的秩是多少，很显然是r=1。其实一般情况：投影矩阵的秩 = **被投影子空间的维度**。

然后我们来看看这个投影矩阵P有什么性质：
（1）他是投影的。$\frac{aa^T}{a^Ta}$中，上面是矩阵，下面是一个数！而上面$(aa^T)^T=(a^T)^Ta^T=aa^T$他是对称的，所以矩阵P是对称的。所以第一个性质是矩阵是对称的！
（2）如果我们再投影一次，我们可以得到的结果与只投影一次并没有区别。所以我们说：$P^2=P$。
以上两条性质是符合所有投影矩阵的，也是我们继续扩展投影概念的基础。

# 平面上的投影
是否还记得我们上一讲最后一部分关于Ax=b无解问题的探讨吗？b无解其实就是因为b不在矩阵A的列空间中！我们以一个三维空间维例子去解答，如下图：
![[../../image/屏幕截图 2025-07-27 222519.png]]
平面A就是矩阵A的列空间。$a_{1},a_{2}$是平面的一组基。b是对应Ax=b中无解的那个b！而e就是垂直平面A的那个法向量。而那个p向量在A平面上等于$\hat{x_{1}}a_{1}+\hat{x_{2}}a_{2}$。或者写成：$p=A\hat{x},A=\begin{bmatrix}a_{1}&a_{2}\end{bmatrix}(其中的𝑎_{n}都是列向量)，\hat{x}=\begin{bmatrix}\hat{x_{1}}\\\hat{x_{2}}\end{bmatrix}$。所以e=b-p=b-$A\hat{x}$
由正交的定义我们得到的是：e是与$a_{1},a_{2}$是正交的。那么$a_{1}^T(b-A\hat{x})=0,a_{2}^T(b-A\hat{x})=0$。合成可以得到的是：$\begin{bmatrix}a_{1}^T\\a_{2}^T\end{bmatrix}(b-A\hat{x})=0,可以说A^T(b-A\hat{x})=0$！这么一看，e是在A的左零空间中的，由我们之前学过四个子空间的正交补关系可得e是垂直于A的列空间的！一切都说得通了，一切都是严丝合缝！那么化简得到的是：$A^TA\hat{x}=A^Tb$。所以上一讲说到这个关键的性质不是空穴来风的！
其实我们也可以这么理解，要在A的列空间中找到一个最接近b的结果空间，就只能是投影最接近了！投影的情况下才会是最优近似解！

而由$A^TA\hat{x}=A^Tb$可以得到的是$\hat{x}=(A^TA)^{-1}A^Tb$。我们知道$p=A\hat{x}$，那么代入得到的是：$p=A\hat{x}=A(A^TA)^{-1}A^Tb$。这就是最通用的投影矩阵的公式。上面的是可以推导的（当A是一条线时，那么$(A^TA)^{-1}$就是一个数，那么投影矩阵就是$\frac{AA^T}{A^TA}$。
首先对于这个式子我想问问大家，可以把$A(A^TA)^{-1}A^T$拆解成：$AA^{-1}(A^T)^{-1}A^T=I$吗，其实是不能的，为什么呢，因为我们说过A是可逆矩阵了吗，显然没有，如果A是的话，对于一个可逆矩阵来收，是不存在找不到的解的！也就是说b一定是在A的列空间中的，那么投影矩阵就是$I$,b本身就是自己的投影！但是如果A不可逆，那么投影矩阵就是：$A(A^TA)^{-1}A^T$！（不可拆开括号！）他同样满足对称与平方相等这两条性质的。感兴趣的同学可以自己证明看看，不难的！
经过这么分析，这就是为什么$A^TA\hat{x}=A^Tb$成立的原因！

# 最小二乘法初涉
经典的最后一部分是后一讲的药引：最小二乘法的初涉！如图：
![[../../image/屏幕截图 2025-07-28 092314.png]]
在一个二维坐标系中有三个点：$a_{1}:(1,1),a_{2}:(2,2),a_{3}:(3,2)$。找出一条直线与这三个点的距离最近。我们假设最优直线方程：y = C + Dx，代入三个点列出方程。得到：$$\begin{cases}C+D=1\\C+2D=2\\C+3D=2\end{cases}$$
很明显这个方程是无解的。也可以说Ax=b无解。但是我们可以$A^TA\hat{x}=A^Tb$化简为这样找出最优解C和D！当然最小二乘法我们下一讲还会深入讨论！

# 讨论课
首先在问题之前我们来说一个事实，以一个例子为切入点吧！当我们有一个矩阵，他的列空间是在三维空间中的一个平面（有3行但是秩为2），那么这个平面的法向量是什么，答案是：列空间正交补空间的基，也就是说平面的法向量是矩阵左零空间的基！也是同一个向量b投影到正交补空间的结果！当然更高维度中也会有这样的关系在，不过会更加复杂！但是在3维或者低纬度空间中是可以帮助我们简便运算的！

好的，我们来看题：
![[../../image/Pasted image 20250728101708.png]]
对于这个平面，找到向量B投影到该平面的投影向量。
（1）在讲座中，strang教授花了很长时间推导的公式我们可以用上了！
$P=A(A^TA)^{-1}A^T$，但是在此之前我们需要求出A。已经知道A的公式的，随便代入得到两个独立的向量是：$\begin{bmatrix}1\\-1\\0\end{bmatrix}和\begin{bmatrix}1\\0\\1\end{bmatrix}$，那么矩阵A就是：$\begin{bmatrix}1&1\\-1&0\\0&1\end{bmatrix}$。那么我们开始计算：$$P=\begin{bmatrix}1&1\\-1&0\\0&1\end{bmatrix}(\begin{bmatrix}1&-1&0\\1&0&1\end{bmatrix}\begin{bmatrix}1&1\\-1&0\\0&1\end{bmatrix})^{-1}\begin{bmatrix}1&-1&0\\1&0&1\end{bmatrix}$$
得到$P=\begin{bmatrix} \frac{2}{3} & -\frac{1}{3} & \frac{1}{3} \\-\frac{1}{3}&\frac{2}{3}&\frac{1}{3}\\\frac{1}{3}&\frac{1}{3}&\frac{2}{3}\end{bmatrix}$

（2）根据向量加法，是不是：b=p+e。而p=Pb，e我们在上面说了法向量是左零空间的基，也是同一个向量b投影到正交补空间的结果！那么$P_{N}b$=e。所以说$b=Pb+P_{N}b\rightarrow Ib=Pb+P_{N}b\rightarrow I=P+P_{N}\rightarrow P=I-P_{N}$
很显然$P_{N}$更好计算，$P_{N}=N(N^TN)^{-1}N^T$。N已经在图中标出！计算得到的结果与解法一一样的！

# 习题课
# 问题一：
设 A 为去掉最后一列的 4×4 单位矩阵，即 A 是一个 4×3 矩阵。将向量 b=(1,2,3,4) 投影到 A 的列空间上。  
问：投影矩阵 P 的形状是什么？P 的具体形式如何？

解答：此时A的列空间就是一整个三维空间！那么投影矩阵P=$A(A^TA)^{-1}A^T=\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\\0&0&0\end{bmatrix}(\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\end{bmatrix}\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\\0&0&0\end{bmatrix})^{-1}\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\\0&0&0&0\end{bmatrix}$。
p=Pb=$\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\\0&0&0&0\end{bmatrix}\begin{bmatrix}1\\2\\3\\4\end{bmatrix}=\begin{bmatrix}1\\2\\3\end{bmatrix}$
# 问题二：
若 $P^2=P$，证明 $(I−P)^2=I−P$。  
对于上一题中的矩阵 A 和 P，P 将向量投影到 A 的列空间上，那么 I−P 将向量投影到哪里？

解答：$(I−P)^2=I^2-IP-PI+P^2=I-2P+P=I-P$，证明完毕！那么$I-P$为$\begin{bmatrix}0&0&0&0\\0&0&0&0\\0&0&0&0\\0&0&0&1\end{bmatrix}$。然后由$I−P$投影的矩阵为$(I−P)b$，而由P投影的结果是：pb。那么$(I−P)bPb=(b-Pb).Pb=bPb-(Pd)^2=0$。那么在讨论课中我们说到过，正交补空间的投影矩阵是正交的！那么与A的列空间正交的空间就是A的左零空间了！